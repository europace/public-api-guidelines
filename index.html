

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <!--[if IE]>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <![endif]-->
  <title>Europace Public RESTful API Guidelines</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
  <link rel="stylesheet" href="assets/css/asciidoctor.css">
  <link rel="stylesheet" href="assets/css/coderay.css">
  <link rel="stylesheet" href="assets/css/custom.css">
  <link rel="stylesheet" href="assets/css/fontawesome.css">
  <link rel="stylesheet" href="assets/css/solid.css">

  <style>
    .fa-check {
      padding-right: 3px;
      color: #00bf00;
    }
    .fa-times {
      padding-right: 3px;
      color: red;
    }
    .fa-exclamation-triangle {
      padding-right: 3px;
      color: #bfbf00;
    }
  </style>

</head>
<body class="article toc2 toc-left">
<div id="header">
  <h1>Europace Public RESTful API Guidelines</h1>
  <div id="toc" class="toc2">
    <div id="toctitle">Table of Contents</div>
    <ul class="sectlevel1">
      <li>
        <a href="#_introduction">1. Introduction</a>
        <ul class="sectlevel2">
          <li><a href="#_conventions">Conventions Used in These Guidelines</a></li>
          <li><a href="#_specificInformation">Europace Specific Information</a></li>
        </ul>
      </li>
      <li>
        <a href="#_principles">2. Principles</a>
        <ul class="sectlevel2">
          <li><a href="#_api_design_principles">API Design Principles</a></li>
          <li><a href="#_api_as_a_product">API as a Product</a></li>
          <li><a href="#_api_first">API First</a></li>
        </ul>
      </li>
      <li>
        <a href="#_general_guidelines">3. General Guidelines</a>
        <ul class="sectlevel2">
          <li><a href="#_general_1"><span class="red">Must:</span> Follow API First Principle</a></li>
          <li><a href="#_general_2"><span class="red">Must:</span> Provide API Specification using OpenAPI</a></li>
          <li><a href="#_general_3"><span class="red">Must:</span> only use Durable and Immutable Remote References</a></li>
          <li><a href="#_general_4"><span class="yellow">Should:</span> Provide API User Manual</a></li>
          <li><a href="#_general_5"><span class="red">Must:</span> Write APIs in domain-specific language</a></li>
        </ul>
      </li>
      <li>
        <a href="#_meta_information">4. Meta Information</a>
        <ul class="sectlevel2">
          <li><a href="#_meta_1"><span class="red">Must:</span> Contain API Meta Information</a></li>
          <li><a href="#_meta_2"><span class="red">Must:</span> Use Semantic Versioning</a></li>
          <li><a href="#_meta_3"><span class="yellow">Should:</span> Provide API Audience</a></li>
        </ul>
      </li>
      <li>
        <a href="#_security">5. Security</a>
        <ul class="sectlevel2">
          <li><a href="#_security_1"><span class="red">Must:</span> Secure Endpoints with OAuth 2.0</a></li>
          <li><a href="#_security_2"><span class="red">Must:</span> Define and Assign Permissions (Scopes)</a></li>
          <li><a href="#_security_3"><span class="red">Must Not:</span> Define Endpoints with Public Access</a></li>
          <li><a href="#_security_4"><span class="red">Must:</span> Follow Naming Convention for Permissions (Scopes)</a></li>
        </ul>
      </li>
      <li>
        <a href="#_compatibility">6. Compatibility</a>
        <ul class="sectlevel2">
          <li><a href="#_compatibility_1"><span class="red">Must:</span> Don’t Break Backward Compatibility</a></li>
          <li><a href="#_compatibility_2"><span class="yellow">Should:</span> Prefer Compatible Extensions</a></li>
          <li><a href="#_compatibility_3"><span class="red">Must:</span> Prepare Clients To Not Crash On Compatible API Extensions</a></li>
          <li><a href="#_compatibility_4"><span class="yellow">Should:</span> Design APIs Conservatively</a></li>
          <li><a href="#_compatibility_5"><span class="yellow">Should:</span> Always Return JSON Objects As Top-Level Data Structures To Support Extensibility</a></li>
          <li><a href="#_compatibility_6"><span class="red">Must:</span> Treat Open API Definitions As Open For Extension By Default</a></li>
          <li><a href="#_compatibility_7"><span class="yellow">Should:</span> Used Open-Ended List of Values Instead of Enumerations</a></li>
          <li><a href="#_compatibility_8"><span class="yellow">Should:</span> Avoid Versioning</a></li>
          <li><a href="#_compatibility_9"><span class="yellow">Should:</span> Use URI Versioning</a></li>
          <li><a href="#_compatibility_10"><span class="green">May:</span> Use Media Type Versioning</a></li>
        </ul>
      </li>
      <li>
        <a href="#_deprecation">7. Deprecation</a>
        <ul class="sectlevel2">
          <li><a href="#_deprecation_1"><span class="red">Must:</span> Obtain Approval of Clients</a></li>
          <li><a href="#_deprecation_2"><span class="red">Must:</span> External Partners Must Agree on Deprecation Timespan</a></li>
          <li><a href="#_deprecation_3"><span class="red">Must:</span> Reflect Deprecation in API Definition</a></li>
          <li><a href="#_deprecation_4"><span class="red">Must:</span> Monitor Usage of Deprecated APIs</a></li>
          <li><a href="#_deprecation_5"><span class="yellow">Should:</span> Add a Warning Header to Responses</a></li>
          <li><a href="#_deprecation_6"><span class="yellow">Should:</span> Add Monitoring for Warning Header</a></li>
          <li><a href="#_deprecation_7"><span class="red">Must Not:</span> Start Using Deprecated APIs</a></li>
        </ul>
      </li>
      <li>
        <a href="#_json_guidelines">8. JSON Guidelines</a>
        <ul class="sectlevel2">
          <li><a href="#_json_guidelines_1"><span class="red">Must:</span> Property names must be ASCII camelCase: <span class="emphasized">^[a-z_][a-z0-9]*$</span></a></li>
          <li><a href="#_json_guidelines_2"><span class="red">Must Not:</span> Define Maps Using <span class="emphasized">additionalProperties</span></a></li>
          <li><a href="#_json_guidelines_3"><span class="yellow">Should:</span> Array names should be pluralized</a></li>
          <li><a href="#_json_guidelines_4"><span class="green">May:</span> Boolean property values may be null</a></li>
          <li><a href="#_json_guidelines_5"><span class="yellow">Should:</span> Null values should have their fields removed</a></li>
          <li><a href="#_json_guidelines_6"><span class="yellow">Should:</span> Empty array values should not be null</a></li>
          <li><a href="#_json_guidelines_7"><span class="yellow">Should:</span> Enumerations should be represented as Strings</a></li>
          <li><a href="#_json_guidelines_8"><span class="red">Must:</span> Date property values must conform to ISO 8601</a></li>
          <li><a href="#_json_guidelines_9"><span class="yellow">Should:</span> Time durations and intervals could conform to ISO 8601</a></li>
          <li><a href="#_json_guidelines_10"><span class="yellow">Should:</span> Standards could be used for Language, Country and Currency</a></li>
        </ul>
      </li>
      <li>
        <a href="#_naming">9. Naming</a>
        <ul class="sectlevel2">
          <li><a href="#_naming_1"><span class="red">Must:</span> Use lowercase separate words with hyphens for Path Segments</a></li>
          <li><a href="#_naming_2"><span class="red">Must:</span> Use camelCase for Query Parameters</a></li>
          <li><a href="#_naming_3"><span class="yellow">Should:</span> Prefer Hyphenated-Pascal-Case for HTTP header Fields</a></li>
          <li><a href="#_naming_4"><span class="red">Must:</span> Pluralize Resource Names</a></li>
          <li><a href="#_naming_5"><span class="yellow">Should:</span> Not Use /api as Base Path</a></li>
          <li><a href="#_naming_6"><span class="yellow">Should Not:</span> Use Trailing Slashes in Resource Path</a></li>
          <li><a href="#_naming_7"><span class="red">Must:</span> Stick to Conventional Query Parameters</a></li>
        </ul>
      </li>
      <li>
        <a href="#_resources">10. Resources</a>
        <ul class="sectlevel2">
          <li><a href="#_resources_1"><span class="red">Must:</span> Avoid Actions — Think About Resources</a></li>
          <li><a href="#_resources_2"><span class="yellow">Should:</span> Model complete business processes</a></li>
          <li><a href="#_resources_3"><span class="yellow">Should:</span> Define resources to meet clients requirements</a></li>
          <li><a href="#_resources_4"><span class="red">Must:</span> Keep URLs Verb-Free</a></li>
          <li><a href="#_resources_5"><span class="red">Must:</span> Use Domain-Specific Resource Names</a></li>
          <li><a href="#_resources_6"><span class="red">Must:</span> Use URL-friendly Resource Identifiers: <span class="emphasized">[a-zA-Z0-9/:._-]*</span></a></li>
          <li><a href="#_resources_7"><span class="red">Must:</span> Identify resources and Sub-Resources via Path Segments</a></li>
          <li><a href="#_resources_8"><span class="yellow">Should Not:</span> Consider Using (Non-) Nested URLs</a></li>
          <li><a href="#_resources_9"><span class="yellow">Should:</span> Limit number of Resource types</a></li>
          <li><a href="#_resources_10"><span class="yellow">Should:</span> Limit number of Sub-Resource Levels</a></li>
        </ul>
      </li>
      <li>
        <a href="#_http_requests">11. HTTP Requests</a>
        <ul class="sectlevel2">
          <li><a href="#_http_requests_1"><span class="red">Must:</span> Use HTTP Methods Correctly</a></li>
          <li><a href="#_http_requests_2"><span class="red">Must:</span> Fulfill Common Method Properties</a></li>
          <li><a href="#_http_requests_3"><span class="yellow">Should:</span> Consider To Design <span class="emphasized">PATCH</span> Idempotent</a></li>
          <li><a href="#_http_requests_4"><span class="yellow">Should:</span> Define Collection Format of Query Parameters and Headers</a></li>
          <li><a href="#_http_requests_5"><span class="red">Must:</span> Document Implicit Filtering</a></li>
        </ul>
      </li>
      <li>
        <a href="#_http_status_codes">12. HTTP Status Codes And Errors</a>
        <ul class="sectlevel2">
          <li><a href="#_http_status_codes_1"><span class="red">Must:</span> Specify Success and Error Responses</a></li>
          <li><a href="#_http_status_codes_2"><span class="red">Must:</span> Use Standard HTTP Status Codes</a></li>
          <li><a href="#_http_status_codes_3"><span class="red">Must:</span> Use Most Specific HTTP Status Codes</a></li>
          <li><a href="#_http_status_codes_4"><span class="red">Must:</span> Use Code 429 with Headers for Rate Limits</a></li>
          <li><a href="#_http_status_codes_5"><span class="red">Must:</span> Use Problem JSON</a></li>
          <li><a href="#_http_status_codes_6"><span class="red">Must:</span> Do not expose Stack Traces</a></li>
        </ul>
      </li>
      <li>
        <a href="#_performance">13. Performance</a>
        <ul class="sectlevel2">
          <li><a href="#_performance_1"><span class="yellow">Should:</span> Reduce Bandwidth Needs and Improve Responsiveness</a></li>
          <li><a href="#_performance_2"><span class="yellow">Should:</span> Use gzip Compression</a></li>
          <li><a href="#_performance_3"><span class="yellow">Should:</span> Support Partial Responses via Filtering</a></li>
          <li><a href="#_performance_4"><span class="red">Must:</span> Document Cacheable <span class="emphasized">GET</span>, <span class="emphasized">HEAD</span>, and <span class="emphasized">POST</span> Endpoints</a></li>
        </ul>
      </li>
      <li>
        <a href="#_pagination">14. Pagination</a>
        <ul class="sectlevel2">
          <li><a href="#_pagination_1"><span class="red">Must:</span> Support Pagination</a></li>
          <li><a href="#_pagination_2"><span class="yellow">Should:</span> Use Offset-Based Pagination, Avoid Cursor-Based Pagination</a></li>
          <li><a href="#_pagination_3"><span class="green">May:</span> Use Pagination Links Where Applicable</a></li>
        </ul>
      </li>
      <li>
        <a href="#_hypermedia">15. Hypermedia</a>
        <ul class="sectlevel2">
          <li><a href="#_hypermedia_1"><span class="red">Must:</span> Use REST Maturity Level 2</a></li>
          <li><a href="#_hypermedia_2"><span class="red">Must:</span> Use fully qualified URI</a></li>
          <li><a href="#_hypermedia_3"><span class="red">Must:</span> Use Common Hypertext Controls</a></li>
          <li><a href="#_hypermedia_4"><span class="red">Must:</span> Use Link Headers with JSON entities</a></li>
        </ul>
      </li>
      <li>
        <a href="#_data_formats">16. Data Formats</a>
        <ul class="sectlevel2">
          <li><a href="#_data_formats_1"><span class="red">Must:</span> Use JSON to Encode Structured Data</a></li>
          <li><a href="#_data_formats_2"><span class="green">May:</span> Use non JSON Media Types for Binary Data or Alternative Content Representations</a></li>
          <li><a href="#_data_formats_3"><span class="yellow">Should:</span> Prefer standard Media type name <span class="emphasized">application/json</span></a></li>
          <li><a href="#_data_formats_4"><span class="red">Must:</span> Use Standard Date and Time Formats</a></li>
          <li><a href="#_data_formats_5"><span class="yellow">Should:</span> Use Standards for Country, Language and Currency Codes</a></li>
          <li><a href="#_data_formats_6"><span class="red">Must:</span> Define Format for Type Number and Integer</a></li>
        </ul>
      </li>
      <li>
        <a href="#_common_data_types">17. Common Data Types</a>
        <ul class="sectlevel2">
          <li><a href="#_common_data_types_1"><span class="yellow">Should:</span> Use a Common Geld Object</a></li>
          <li><a href="#_common_data_types_2"><span class="red">Must:</span> Use common field names and semantics</a></li>
        </ul>
      </li>
      <li>
        <a href="#_common_headers">18. Common Headers</a>
        <ul class="sectlevel2">
          <li><a href="#_common_headers_1"><span class="red">Must:</span> Use <span class="emphasized">Content-*</span> Headers Correctly</a></li>
          <li><a href="#_common_headers_2"><span class="green">May:</span> Use Standardized Headers</a></li>
          <li><a href="#_common_headers_3"><span class="green">May:</span> Use <span class="emphasized">Content-Location</span> Header</a></li>
          <li><a href="#_common_headers_4"><span class="yellow">Should:</span> Use <span class="emphasized">Location</span> Header instead of <span class="emphasized">Content-Location</span> Header</a></li>
          <li><a href="#_common_headers_5"><span class="green">May:</span> Consider to Support <span class="emphasized">ETag</span> Together With <span class="emphasized">If-Match</span>/<span class="emphasized">If-None-Match</span> Header</a></li>
        </ul>
      </li>
      <li>
        <a href="#_proprietary_headers">19. Proprietary Headers</a>
        <ul class="sectlevel2">
          <li><a href="#_proprietary_headers_1"><span class="red">Must:</span> Use Only the Specified Proprietary Europace Headers</a></li>
          <li><a href="#_proprietary_headers_2"><span class="red">Must:</span> Propagate Proprietary Headers</a></li>
          <li><a href="#_proprietary_headers_3"><span class="red">Must:</span> Use <span class="emphasized">X-TraceId</span></a></li>
        </ul>
      </li>
      <li>
        <a href="#_api_operation">20. API Operation</a>
        <ul class="sectlevel2">
          <li><a href="#_api_operation_1"><span class="red">Must:</span> Publish OpenAPI Specification</a></li>
          <li><a href="#_api_operation_2"><span class="yellow">Should:</span> Monitor API Usage</a></li>
        </ul>
      </li>
      <li>
        <a href="#_appendix">Appendix: References</a>
        <ul class="sectlevel2">
          <li><a href="#_appendix_1">OpenAPI Specification</a></li>
          <li><a href="#_appendix_2">Publications, specifications and standards</a></li>
        </ul>
      </li>
    </ul>
  </div>
</div>
<div id="content">
  <div class="sect1">
    <h2 id="_introduction">1. Introduction</h2>
    <div class="sectionbody">
      <div class="paragraph">
          <p>These guidelines is a derivative of <a href="https://opensource.zalando.com/restful-api-guidelines/#_zalando_restful_api_and_event_scheme_guidelines" target="_blank">"Zalando RESTful API and Event Scheme Guidelines"</a> by Zalando SE, used under <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY</a>.</p>
        <p>Europace provides access to it’s core business functionality via RESTful APIs with a JSON payload. These APIs are engineered, deployed, operated and maintained as microservices in a distributed environment. Designing high-quality, long-lasting and easy to use APIs is crucial to us because of the increasing requirements to include Europace platform functionality into 3rd party software.</p>
        <p>Regarding this, we follow “API First” principle as one of our most important engineering goals. API Microservices are first defined outside of the code and ideally reviewed by peers before implementation begins.</p>
        <p>API First embraces quality related standards and a high quality review procedure. With following these principles we aim to create APIs:</p>
        <ul>
          <li>easy to understand and learn</li>
          <li>general and abstracted from specific implementation and use cases</li>
          <li>robust and easy to use</li>
          <li>with a common look and feel</li>
          <li>with a consistent RESTful style and syntax</li>
        </ul>
        <p>Ideally, all Europace APIs will look like the same author created them.</p>
      </div>
      <div class="sect2">
        <h3 id="_conventions">Conventions Used in These Guidelines</h3>
        <div class="paragraph">
          <p>The requirement level keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" used in this document (case insensitive) are to be interpreted as described in <a href="https://www.ietf.org/rfc/rfc2119.txt" target="_blank">RFC 2119.</a></p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_specificInformation">Europace Specific Information</h3>
        <div class="paragraph">
          <p>The purpose of our "RESTful API guidelines" is to define standards to successfully establish "consistent API look and feel" quality. This document is drafted and owned by the Europace API developers. Teams are responsible to fulfill these guidelines during API development and are encouraged to contribute to guideline evolution via pull requests.</p>
          <p>These guidelines will, to some extent, remain work in progress as our work evolves, but teams can confidently follow and trust them.</p>
          <p>In case guidelines are changing, following rules apply:</p>
          <ul>
            <li>existing APIs don’t have to be changed, but we recommend it</li>
            <li>clients of existing APIs have to cope with these APIs based on outdated rules</li>
            <li>new APIs have to respect the current guidelines</li>
          </ul>
          <p>Furthermore you should keep in mind that once an API becomes public externally available, it has to be re-reviewed and changed according to current guidelines - for sake of overall consistency.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_principles">2. Principles</h2>
    <div class="sectionbody">
      <div class="sect2">
        <h3 id="_api_design_principles">API Design Principles</h3>
        <div class="paragraph">
          <p>Europace’s business data resources are exposed via RESTful APIs identified by URIs.They can be modified via standardized CRUD-like methods using different representations and hypermedia. RESTful APIs come with a loose client / server coupling and are suitable for an ecosystem of (core) services providing a platform of APIs to build new business services. We apply the RESTful web service principles to all kind of application (micro-) service components, independently from whether they provide functionality via the internet or intranet. With this in mind, we prefer</p>
          <ul>
            <li>REST-based APIs with JSON payloads</li>
            <li>systems to be truly RESTful</li>
          </ul>
          <p>An important principle for API design and usage is Postel’s Law, aka <a href="https://en.wikipedia.org/wiki/Robustness_principle" target="_blank">The Robustness Principle</a> (see also <a href="https://tools.ietf.org/html/rfc1122" target="_blank">RFC 1122</a>):</p>
          <ul>
            <li>Be liberal in what you accept, be conservative in what you send</li>
          </ul>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_api_as_a_product">API as a Product</h3>
        <div class="paragraph">
          <p>Our business platform products provide core value parts of their functionality via (public) APIs; the design of our APIs should therefore follow the API as a Product principle:</p>
          <ul>
            <li>Treat your API as product and act like a product owner</li>
            <li>Put yourself into the place of your customers; be an advocate for their needs</li>
            <li>Make your APIs simple, easy to understand and easy to use to make them irresistible for client engineers</li>
            <li>Actively improve and maintain API consistency over the long term</li>
            <li>Make use of customer feedback and provide service level support</li>
          </ul>
          <p>Following  'API as a Product' principle enables the creation and maintenance of a service ecosystem which can be evolved in a very feasible way. Following this principle distinguishes an agile, innovative business product built on a platform of APIs from ordinary enterprise integration where APIs are perceived as an "appendix" of existing products optimized for local server-side system integration.</p>
          <p>To design APIs following the “API as a Product” principle:</p>
          <ul>
            <li>understand the use cases of your customers</li>
            <li>check the trade-offs of your API design variants with a product mindset</li>
            <li>do not implement short-term optimizations at the expense of unnecessary client side obligations</li>
            <li>show high attention on API quality and client developer experience.</li>
          </ul>
          <p>API as a Product principle bears a close relationship to API First principle (see next chapter) which is more focused on how we design and engineer our APIs.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_api_first">API First</h3>
        <div class="paragraph">
          <p>API First is one of our engineering and architecture principles. Basically, API First requires two aspects:</p>
          <ul>
            <li>define APIs first, before coding its implementation, using a standard specification language</li>
            <li>get early review feedback from peers and client developers</li>
          </ul>
          <p>By defining APIs first, before the actual implementation, we provide the possibility of early review feedback and also create a development environment able to focus the service interface design on:</p>
          <ul>
            <li>profound understanding of the domain and required functionality</li>
            <li>generalized business entities / resources instead of use case specific APIs</li>
            <li>abstraction from implementation details, aiming to focus on the WHAT instead of the HOW aspects - enabling us to keep our APIs stable even if the complete service implementation is replaced underneath the service interface (including even the underlying technology stack)</li>
          </ul>
          <p>API definitions with a standardized specification format also facilitate…​</p>
          <ul>
            <li>single source of truth for the API specification as a critical part of the contract between service provider and client users</li>
            <li>infrastructure tooling for API discovery, API GUIs, API documents, automated quality checks</li>
          </ul>
          <p>Elements of our API First strategy are also:​</p>
          <ul>
            <li>these API Guidelines</li>
            <li>a standardized API review process to get early review feedback from peers and client developers.</li>
          </ul>
          <p>Peer review is important for us to meet client user expectations, but also very importantly to get high quality and easy to understand and use service interfaces. It enables architectural and design alignment to create a consistent look and feel over all our public APIs. This in connection with focusing on the WHAT aspects support the development of client applications decoupled from service provider engineering life cycle.</p>
          <p>Let it be noted here, that API First principle is <b>not in conflict with the agile development principles</b>. Service applications evolve incrementally — and so APIs can and must too. This means, API specification is subject to evolution and iterative changes, but always starting with the draft definition outside the code and early team and peer review. APIs may change over time, the may profit from implementation aspects, underlying technology stack and automated test feedback. API lifecycle may include breaking changes for not yet productive features or in alignment with client agreements.</p>
          <p>Therefore, even with API First principle in mind, does not mean that 100% domain and requirement understanding is necessary to produce APIs, or that you can never produce code before you have defined the complete API and get it confirmed by peer review. But the principle is in conflict practice of publishing API definition and asking for peer review after the service integration or even the service productive operation has started. To request and get early feedback for an API definition is crucial to create high quality APIs meeting client requirements as best as possible in an efficient and effective way. Nevertheless, to request feasible peer review feedback it is necessary to define the API changes comprehensible with focus to the next evolution step with a decided quality meeting the API Guidelines and being approved in team internal reviews.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_general_guidelines">3. General Guidelines</h2>
    <div class="sectionbody">
      <div class="paragraph">
        <p>The titles are marked with the corresponding labels: <b class="red">Must:</b>, <b class="red">Must Not:</b>, <b class="yellow">Should:</b>, <b class="yellow">Should Not:</b>, <b class="green">May:</b>.</p>
      </div>
      <div class="sect2">
        <h3 id="_general_1"><span class="red">Must:</span> Follow API First Principle</h3>
        <div class="paragraph">
          <p>You must follow the API First Principle, more specifically:</p>
          <ul>
            <li>You must define APIs first, before coding its implementation, using OpenAPI as specification language</li>
            <li>You must design your APIs consistently with this guidelines</li>
            <li>You must call for early review feedback from peers and client developers, and apply our API review process for all component external APIs</li>
          </ul>
        </div>
        <h3 id="_general_2"><span class="red">Must:</span> Provide API Specification using OpenAPI</h3>
        <div class="paragraph">
          <p>We use the <a href="http://swagger.io/specification/" target="_blank">OpenAPI specification</a> as standard to define API specification files. API designers are required to provide the API specification using a single <b>self-contained YAML</b> file to improve readability. Most of our current APIs still use <b>OpenAPI 2.0</b> version, but for future we encourage to use <b>OpenAPI 3.0</b>.</p>
          <p>The API specification files must be version controlled using a source code management system - best together with the implementing sources.</p>
          <p>You must / should publish the component external / internal API specification with the deployment of the implementing service, and, hence, make it discoverable for the group via our GitHub Repository.</p>
        </div>
        <h3 id="_general_3"><span class="red">Must:</span> only use Durable and Immutable Remote References</h3>
        <div class="paragraph">
          <p>Normally, API specification files should be <b>self-contained</b>, i.e. files should not contain references to local or remote content, e.g. <code><span class="green">$ref</span>: <span class="blue">"#/definitions/Eintrag"</span></code>. The reason is, that the content referred to is <i>in general</i> <b>not durable</b> and <b>not immutable</b>. As a consequence, the semantic of an API may change in unexpected ways.</p>
          <p>However, you may use local and remote references to resources accessible in a verified Europace GitHub repository (<a href="https://github.com/europace" target="_blank">https://github.com/europace</a>).</p>
          <p>As we control these URLs, we ensure that their content is <b>durable</b> and <b>immutable</b>. This allows to define API specifications by using fragments published via this sources, as suggested in <a href="#_http_status_codes_1"><b><span class="red">Must:</span> Specify Success and Error Responses</b></a>.</p>
        </div>
        <h3 id="_general_4"><span class="yellow">Should:</span> Provide API User Manual</h3>
        <div class="paragraph">
          <p>In addition to the API Specification, we consider it good practice to provide an API user manual to improve client developer experience. A helpful API user manual typically describes the following API aspects:</p>
          <ul>
            <li>API scope, purpose, and use cases</li>
            <li>specific examples of API usage</li>
            <li>edge cases, error situation details, and repair hints</li>
            <li>architecture context and major dependencies</li>
          </ul>
          <p>The user manual typically will be published in the APIs GitHub repository (<a href="https://github.com/europace" target="_blank">https://github.com/europace</a>)</p>
        </div>
        <h3 id="_general_5"><span class="red">Must:</span> Write APIs in domain-specific language</h3>
        <div class="paragraph">
          <p>The business domain of Europace APIs is very country specific. A lot of the vocabulary used in this domain only exists in German. Nevertheless, US English is a worldwide recognized language to write computer software in. Therefore we distinguish two variants for naming resources in our APIs:</p>
          <ul>
            <li>use German for business domain specific resources</li>
            <li>use English for technical resources and standard program parts</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_meta_information">4. Meta Information</h2>
    <div class="sectionbody">
      <div class="sect2">
        <h3 id="_meta_1"><span class="red">Must:</span> Contain API Meta Information</h3>
        <div class="paragraph">
          <p>API specifications must contain the following OpenAPI meta information to allow for API management:</p>
          <ul>
            <li><span class="emphasized">#/info/title</span> as (unique) identifying, functional descriptive name of the API</li>
            <li><span class="emphasized">#/info/version</span> to distinguish API specifications versions following <a href="#_meta_2">semantic rules</a></li>
            <li><span class="emphasized">#/info/description</span> containing a proper description of the API</li>
            <li><span class="emphasized">#/info/contact/{name,url,email}</span> containing the responsible team</li>
          </ul>
          <p>Following OpenAPI extension property <b class="yellow">should</b> be provided in addition:</p>
          <ul>
            <li><span class="emphasized">#/info/x-audience</span> intended target audience of the API (see <a href="#_meta_3"><b><span class="yellow">Should:</span> Provide API Audience</b></a>)</li>
          </ul>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_meta_2"><span class="red">Must:</span> Use Semantic Versioning</h3>
        <div class="paragraph">
          <p>OpenAPI allows to specify the API specification version in <span class="emphasized">#/info/version</span>. To share a common semantic of version information we expect API designers to comply to <a href="https://semver.org/spec/v2.0.0.html" target="_blank">Semantic Versioning 2.0</a> rules <b>1</b> to <b>8</b> and <b>11</b> restricted to the format &lt;MAJOR&gt;.&lt;MINOR&gt;.&lt;PATCH&gt; for versions as follows:</p>
          <ul>
            <li>Increment the <b>MAJOR</b> version when you make incompatible API changes after having aligned this changes with consumers,</li>
            <li>Increment the <b>MINOR</b> version when you add new functionality in a backwards-compatible manner, and</li>
            <li>Increment the <b>PATCH</b> version when you make backwards-compatible bug fixes or editorial changes not affecting the functionality.</li>
          </ul>
          <p><b>Additional Notes:</b></p>
          <ul>
            <li><b>Pre-release</b> versions (<a href="https://semver.org/spec/v2.0.0.html#spec-item-9" target="_blank">rule 9</a>) and <b>build metadata</b> (<a href="https://semver.org/spec/v2.0.0.html#spec-item-10" target="_blank">rule 10</a>) must not be used in API version information.</li>
            <li>While patch versions are useful for fixing typos etc, API designers are free to decide whether they increment it or no</li>
            <li>API designers should consider to use API version <b>0.y.z</b> (<a href="https://semver.org/spec/v2.0.0.html#spec-item-4" target="_blank">rule 4</a>) for initial API design.</li>
          </ul>
          <p>Example:</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              <span class="purple">swagger</span>: <span class="red">”2.0”</span><br/>
              <span class="purple">description</span>: <span class="red">”Mit dieser API…”</span><br/>
              <span class="purple">version</span>: <span class="red">”2.13.0”</span><br/>
              <span class="purple">title</span>: <span class="red">”Anträge auslesen API”</span><br/>
              <span class="purple"><...></span>
            </code>
          </p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_meta_3"><span class="yellow">Should:</span> Provide API Audience</h3>
        <div class="paragraph">
          <p>Basically all of our APIs should follow the same standards in terms of security, usability, discoverability, quality of design and documentation, to make a switch from internal use to external use as swift and easy as possible.</p>
          <p>Nevertheless, to enable developers to easily assess impact and risk of (breaking) changes in an API we strongly recommend the classification of each API with respect to the intended target audience supposed to access the API.</p>
          <p>We differentiate the following API audience groups with clear organisational and legal boundaries:</p>
          <p><b>component-internal</b></p>
          <p class="indented-custom">APIs with this audience are restricted to applications of the same <b>functional component</b> with clear functional scope and ownership. All services of a functional component / product are owned by a specific dedicated owner and engineering team(s). Since developers in this case typically have full control of the consumers of the API as well as the API itself, breaking changes in the API are easy to handle and do not need extensive approval process.</p>
          <p style="padding-left: 1.5em"><b>business-unit-internal</b></p>
          <p class="indented-custom">APIs with this audience are restricted to applications of a specific product portfolio owned by the same business unit. (Breaking) changes are still easily feasible but should be agreed upon and reviewed in the unit.</p>
          <p style="padding-left: 3em"><b>company-internal</b></p>
          <p class="indented-custom">APIs with this audience are restricted to applications owned by the business units of the same the company (e.g. MP, PKU, PBU, PEP inside of Europace, but also further Hypoport companies as Genopace, FINMAS...). Changes in these APIs should already follow the agreed upon specification and documentation process, including full team and peer review. In the principle of InnerSource, contributions to APIs of other business units are strongly supported, nevertheless, the intended changes should be agreed upon by the code owning unit before the implementation.</p>
          <p style="padding-left: 4.5em"><b>external-partner</b></p>
          <p class="indented-custom">APIs with this audience are restricted to applications of business partners of the company owning the API and the company itself. Changes in these APIs have to strictly follow these guidelines, especially in terms of specification, versioning, internal and peer review and documentation. Breaking changes are to be avoided, and if this is not possible have to be agreed upon with all external partners consuming the API.</p>
          <p style="padding-left: 6em"><b>external-public</b></p>
          <p class="indented-custom">As of now, Europace is not planning to provide APIs with external public access.</p>
          <p>The API audience is provided as API meta information in the info-block of the Open API specification and must conform to the following specification:</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              <span class="silver"><i>#/info/x-audience:</i></span><br/>
              <span class="purple">type</span>: <span class="red">string</span><br/>
              <span class="purple">enum</span>:<br/>
              <span style="padding-left: 1em;">- <span class="red">component-internal</span></span><br/>
              <span style="padding-left: 1em;">- <span class="red">business-unit-internal</span></span><br/>
              <span style="padding-left: 1em;">- <span class="red">company-internal</span></span><br/>
              <span style="padding-left: 1em;">- <span class="red">external-partner</span></span><br/>
              <span style="padding-left: 1em;">- <span class="red">external-public</span></span><br/>
              <span class="purple">description</span>: <span class="red">|</span><br/>
              <span class="red">
                <span style="padding-left: 1em;">Intended target audience of the API. Relevant for standards around</span><br/>
                <span style="padding-left: 1em;">quality of design and documentation, reviews, discoverability,</span><br/>
                <span style="padding-left: 1em;">changeability, and security / permission granting.</span>
              </span>
            </code>
          </p>
          <p><b>Note:</b> Europace’s APIs are working on a highly language specific domain. A lot of the code is therefore written and documented in German. The example above is written in English for consistency reasons with the guideline document. When using the above described headers, feel free to use German in the OpenAPI definition of your API.</p>
          <p><b>Note:</b> Exactly <b>one audience</b> per API specification is allowed. For this reason a smaller audience group is intentionally included in the wider group and thus does not need to be declared additionally. If parts of your API have a different target audience, we recommend to split API specifications along the target audience — even if this creates redundancies.</p>
          <p>Example:</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              <span class="purple">swagger</span>: <span class="red">"2.0"</span><br/>
              <span class="purple">info</span>:<br/>
              <span style="padding-left: 1em;"><span class="purple">x-audience</span>: <span class="red">"external-partner"</span></span><br/>
              <span style="padding-left: 1em;"><span class="purple">description</span>: <span class="red">"Mit dieser API…"</span></span><br/>
              <span style="padding-left: 1em;"><span class="purple">version</span>: <span class="red">"2.13.0"</span></span><br/>
              <span style="padding-left: 1em;"><span class="purple">title</span>: <span class="red">"Anträge auslesen API"</span></span><br/>
              <span style="padding-left: 1em;"><span class="purple"><...></span></span>
            </code>
          </p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_security">5. Security</h2>
    <div class="sectionbody">
      <div class="sect2">
        <h3 id="_security_1"><span class="red">Must:</span> Secure Endpoints with OAuth 2.0</h3>
        <div class="paragraph">
          <p>Every API endpoint needs to be secured using OAuth 2.0. Please refer to the <a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md#security-definitions-object" target="_blank">official OpenAPI spec</a> on how to specify security definitions in your API specification.</p>
          <p class="placeholder">Platzhalter: Beispiel in API Specification (aka Swagger-File). Um die benötigten Berechtigungen auch den API-Nutzern sichtbar werden zu lassen, reicht es nicht aus, den Endpunkt im Code abzusichern, die Absicherungsparameter sollten bereits in der Spezifikation festgelegt werden.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_security_2"><span class="red">Must:</span> Define and Assign Permissions (Scopes)</h3>
        <div class="paragraph">
          <p>APIs must define permissions to protect their resources. Thus, at least one permission must be assigned to each endpoint. Permissions are defined as shown in the <a href="#_security_1">previous section</a>.</p>
          <p>For the naming schema for permissions please refer to <a href="#_security_4"><b><span class="red">Must:</span> Follow Naming Convention for Permissions (Scopes)</b></a> for designing permission names.</p>
          <p>APIs should stick to component specific permissions without resource extension to avoid governance complexity of too many fine grained permissions. For the majority of use cases, restricting access to specific API endpoints using read and write is sufficient for controlling access. However, in some situations a more fine granular permission granting is needed (e.g. create and delete vs. write permission).</p>
          <p>Some examples for standard and resource-specific permissions:</p>
          <p class="placeholder">Platzhalter: Beispiele einfügen, wenn Auth2-Team Naming Conventions für Permissions erstellt hat.</p>
          <p>After permission names are defined and the permission is declared in the security definition at the top of an API specification, it should be assigned to each API operation by specifying a <a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md#securityRequirementObject" target="_blank">security requirement</a> like this:</p>
          <p class="placeholder"></p>
          <p><b>Hint:</b> you need not explicitly define the "Authorization" header; it is a standard header so to say implicitly defined via the security section.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_security_3"><span class="red">Must Not:</span> Define Endpoints with Public Access</h3>
        <div class="paragraph">
          <p>Europace API endpoints are not allowed to have public access, each endpoint has to be secured in the way described in the previous section. At least one permission has to assigned to each endpoint.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_security_4"><span class="red">Must:</span> Follow Naming Convention for Permissions (Scopes)</h3>
        <div class="paragraph">
          <p>Permission names in APIs must conform to the following naming pattern:</p>
          <p class="placeholder">Pattern hinzufügen, wenn durch Auth2-Team spezifiziert.</p>
          <p>This pattern is compatible with the previous definition.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_compatibility">6. Compatibility</h2>
    <div class="sectionbody">
      <div class="sect2">
        <h3 id="_compatibility_1"><span class="red">Must:</span> Don’t Break Backward Compatibility</h3>
        <div class="paragraph">
          <p>Of course it is necessary to change APIs over time to evolve them and keep them up to their purpose. But changes have to be introduced in a way so consumers can trust in using these APIs without pain. Consumers usually have independent release lifecycles, they focus on stability, and are not willing to introduce changes not providing additional value to them. APIs are contracts between service providers and service consumers that cannot be broken via decisions from one side only.</p>
          <p>There are two techniques to change APIs without breaking them:</p>
          <ul>
            <li>follow rules for compatible extensions</li>
            <li>introduce new API versions and still support older versions</li>
          </ul>
          <p>We strongly prefer technique 1: using compatible API extensions and discourage technique 2: versioning (see <a href="#_compatibility_8"><b><span class="yellow">Should:</span> Avoid Versioning</b></a> and <a href="#_compatibility_10"><b><span class="green">May:</span> Use Media Type Versioning</b></a> below). The following guidelines for service providers (<a href="#_compatibility_2"><b><span class="yellow">Should:</span> Prefer Compatible Extensions</b></a>) and consumers (<a href="#_compatibility_3"><b><span class="red">Must:</span> Prepare Clients To Not Crash On Compatible API Extensions</b></a>) enable us (having Postel’s Law in mind) to make compatible changes without versioning.</p>
          <p><b>Note:</b> There is a difference between incompatible and breaking changes. Incompatible changes are changes that are not covered by the compatibility rules below. Breaking changes are incompatible changes deployed into operation, and thereby breaking running API consumers. Usually, incompatible changes are breaking changes when deployed into operation. However, in specific controlled situations it is possible to deploy incompatible changes in a non-breaking way, if no API consumer is using the affected API aspects (see also <a href="#_deprecation">Deprecation</a> guidelines).</p>
          <p><b>Hint:</b> Please note that the compatibility guarantees are for the "on the wire" format. Binary or source compatibility of code generated from an API definition is not covered by these rules. If client implementations update their generation process to a new version of the API definition, it has to be expected that code changes are necessary.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_compatibility_2"><span class="yellow">Should:</span> Prefer Compatible Extensions</h3>
        <div class="paragraph">
          <p>API designers should apply the following rules to evolve RESTful APIs for services in a backward-compatible way:</p>
          <ul>
            <li>Add only optional, never mandatory fields.</li>
            <li>Never change the semantic of fields</li>
            <li>Input parameters and fields may have a (complex) validation logic on the server side. All validated constraints must be clearly defined in API specification/documentation. The validation logic must not be changed to be more restrictive on the server side.</li>
            <li>Input parameter enum ranges can only be reduced, if the server can accept and handle old range values too. Output parameter Enum ranges can be reduced.</li>
            <li>Output parameter enum ranges cannot be extended, as clients might be not able to handle new values. Input parameter enum ranges can be extended.</li>
            <li>To be able to extend output parameter ranges without above restriction, to meet growing functionality requirements, do not use enumerations for output values, but open value list instead. An open list of explicit values can be documented, but clients must be agnostic as to new values in this list. This way extension of the values in the list is easily feasible without breaking the API.</li>
            <li>Support redirection in case an URL has to change <a href="#_status_code_301"><b>301 (Moved Permanently)</b></a>.</li>
          </ul>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_compatibility_3"><span class="red">Must:</span> Prepare Clients To Not Crash On Compatible API Extensions</h3>
        <div class="paragraph">
          <p>To follow robustness principle, service clients should:</p>
          <ul>
            <li>be conservative with API requests and data passed as input, e.g. do not exploit definition deficits like passing megabytes of strings with unspecified maximum length.</li>
            <li>be tolerant in processing and reading data of API responses, more specifically…</li>
            <li>be prepared for compatible API extensions of service providers:
              <ul>
                <li>be tolerant with unknown fields in the payload (see also Fowler’s <a href="http://martinfowler.com/bliki/TolerantReader.html" target="_blank">"TolerantReader"</a> post), i.e. ignore new fields, but do not remove them from the payload, as they might be needed for subsequent requests</li>
                <li>be prepared that return parameters with predefined value lists can return unknown values, either ignore or provide default behavior</li>
                <li>be prepared to handle HTTP status codes even if not explicitly specified in endpoint definitions. Note also that status codes are extensible. Default handling would treat the corresponding <a href="#_success_codes"><b>2xx</b></a> code (see <a href="https://tools.ietf.org/html/rfc7231#section-6" target="_blank">RFC7231</a>)</li>
                <li>follow redirect when server returns with HTTP status code <a href="#_status_code_301"><b>301 (Moved Permanently)</b></a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_compatibility_4"><span class="yellow">Should:</span> Design APIs Conservatively</h3>
        <div class="paragraph">
          <p>Our service provider API design should follow Postel’s Law aka <a href="https://en.wikipedia.org/wiki/Robustness_principle" target="_blank">the Robustness Principle</a> as best as possible:</p>
          <p class="text-center"><i>Be conservative in what you do, be liberal in what you accept from others</i></p>
          <ul>
            <li>Unknown input fields in payload or URLs should be ignored; it is possible, that the resulting response is not meeting the clients expectation, e.g. it might be a simple typo in the parameter name. To find errors like this easily, you should log the provision of unknown input fields. </li>
            <li>Be accurate in defining input data constraints (like formats, ranges, lengths etc.) in the API documentation. Check these constraints accurate to this definition and return meaningful error information in case of violations.</li>
            <li>Be rather more specific and restrictive (as long as not being in conflict with functional requirements), e.g. by defining length range of strings. It can make implementation easier, but provides freedom for further evolution and extension of the API.</li>
          </ul>
          <p>Following the Robustness Principle in ignoring unknown input fields can however result in the following problems. Be aware of these possible problems, make them explicitly visible when they occur and be ready to define a solution:</p>
          <ul>
            <li>Ignoring unknown input fields in <a href="#_http_method_put"><span class="emphasized">PUT</span></a> requests leads to an asymmetry with subsequent <a href="#_http_method_get"><span class="emphasized">GET</span></a> response (since the ignored fields will be missing). HTTP is clear about the <a href="#_http_method_put"><span class="emphasized">PUT</span></a> <i>replace</i> semantics and default roundtrip expectations (see <a href="https://tools.ietf.org/html/rfc7231#section-4.3.4" target="_blank">RFC 7231 Section 4.3.4</a>).</li>
            <li>Certain client errors cannot be recognized by servers, e.g. attribute name typing errors will be ignored without server error feedback. The server cannot differentiate between the client intentionally providing an additional field versus the client sending a mistakenly named field, when the client’s actual intent was to provide an optional input field. To be able to find such errors easily, you should log unknown input fields.</li>
            <li>Submitting of new input fields to the input data structure might change until now ignored fields to valid input data. This can result in a breaking API change, because behavior of API can change in an unexpected way for the client.</li>
          </ul>
          <p>When a known input field is not needed anymore there a two possibilities in handling it without breaking the API:</p>
          <ul>
            <li>it can stay in the API definition with a “not used anymore” description</li>
            <li>it can be removed from the API definition and be ignored by the API in the future.</li>
          </ul>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_compatibility_5"><span class="yellow">Should:</span> Always Return JSON Objects As Top-Level Data Structures To Support Extensibility</h3>
        <div class="paragraph">
          <p>In a response body, you should always return a JSON object (and not e.g. an array) as a top level data structure to support future extensibility. JSON objects support compatible extension by additional attributes. This allows you to easily extend your response and e.g. add pagination later, without breaking backwards compatibility.</p>
          <p>We strongly recommend using <a href="http://stateless.co/hal_specification.html" target="_blank">HAL (Hypertext Application Language)</a> JSON format for an APIs response body. Because it allows for easily adding links to the response body as well as the resource data itself.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_compatibility_6"><span class="red">Must:</span> Treat Open API Definitions As Open For Extension By Default</h3>
        <div class="paragraph">
          <p>The Open API 2.0 specification is not specific on default extensibility of objects. JSON-Schema keywords are redefined related to extensibility, e.g. <span class="emphasized">additionalProperties</span>. To follow our overall compatibility guidelines, we consider Open API object definitions open for extension by default as per <a href="http://json-schema.org/latest/json-schema-validation.html#rfc.section.6.5.6" target="_blank">Section 6.5.6 "additionalProperties"</a> of JSON-Schema.</p>
          <p>When it comes to Open API 2.0, this means an <span class="emphasized">additionalProperties</span> declaration is not required and even discouraged to make an object definition extensible:</p>
          <ul>
            <li>API clients consuming data must not assume that objects are closed for extension in the absence of an <span class="emphasized">additionalProperties</span> declaration and must ignore fields sent by the server they cannot process. This allows API servers to evolve their data formats.</li>
            <li>API servers receiving unexpected data should ignore unknown fields (see <a href="#_compatibility_4"><b><span class="yellow">Should:</span> Design APIs Conservatively</b></a>). API designers must document clearly how unexpected fields are handled for <a href="#_http_method_put"><span class="emphasized">PUT</span></a>, <a href="#_http_method_post"><span class="emphasized">POST</span></a>, and <a href="#_http_method_patch"><span class="emphasized">PATCH</span></a> requests.</li>
          </ul>
          <p>API formats must not declare <span class="emphasized">additionalProperties</span> to be false, as this prevents objects being extended in the future.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_compatibility_7"><span class="yellow">Should:</span> Used Open-Ended List of Values Instead of Enumerations</h3>
        <div class="paragraph">
          <p>Per definition, enumerations are closed sets of values, assumed complete and not intended for extension. When an enumeration has to be extended by new values, this might result in compatibility issues with API consumers. To avoid this, we strongly recommend use open-ended lists of values instead of closed enumerations. Exceptions to this pattern are:</p>
          <ol>
            <li>the API has full control of the enumeration values, i.e. the list of values does not depend on any external tool or interface, and</li>
            <li>the list of value is complete with respect to any thinkable and unthinkable future feature.</li>
          </ol>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_compatibility_8"><span class="yellow">Should:</span> Avoid Versioning</h3>
        <div class="paragraph">
          <p>Whenever possible, changes in our RESTful APIs should be done in a backwards compatible way, avoiding generation of new API versions. Having multiple versions of an API significantly complicate understanding, maintenance and testing, but also release and operation of the API service.</p>
          <p>If the API can’t be changed in a compatible way, then proceed in one of these three ways:</p>
          <ol>
            <li>create a new resource (variant) in addition to the old resource variant</li>
            <li>create a new API version supported in parallel with the old API by the same microservice </li>
            <li>create a new service endpoint — i.e. a new application with a new API (with a new domain name)</li>
          </ol>
          <p>The above mentioned ways are in order, please prefer creating a new resource (variant) before creating a new API version or creating a new service endpoint.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_compatibility_9"><span class="yellow">Should:</span> Use URI Versioning</h3>
        <div class="paragraph">
          <p>When API versioning is unavoidable, use URI versioning to design your multi-version APIs.</p>
          <p>With URI versioning a (major) version number is included in the path, e.g. <span class="emphasized">/v1/antraege</span>.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_compatibility_10"><span class="green">May:</span> Use Media Type Versioning</h3>
        <div class="paragraph">
          <p>You  may consider, instead of using URI versioning, using media type versioning for versioning your APIs. Media type versioning is less tightly coupled since it supports content negotiation and hence reduces complexity of release management.</p>
          <p>Media type versioning: Here, version information and media type are provided together via the HTTP Content-Type header — e.g. <span class="emphasized">application/x.europace.antraege+json;version=2</span>. For incompatible changes, a new media type version for the resource is created. To generate the new representation version, consumer and producer can do content negotiation using the HTTP Content-Type and Accept headers.</p>
          <p>As of now, media type versioning is not yet implemented in any of Europace’s public APIs and only listed here as versioning possibility for future implementations to avoid URI versioning when the different versions become too complex to maintain. The above mentioned content type is only an example and not yet processed anywhere in the code.</p>
          <p>To support media type versioning API consumers also have to apply the content type, so before using this kind of versioning Europace partners have to be part of the negotiation process.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_deprecation">7. Deprecation</h2>
    <div class="sectionbody">
      <div class="paragraph">
        <p>There are several reasons why it might become necessary to shut down an API endpoint (or a version), for instance:</p>
        <ul>
          <li>a field is not longer supported in the result</li>
          <li>the business functionality behind an endpoint is not longer used and has to be shut down</li>
          <li>...</li>
        </ul>
        <p>As long as API endpoints are used by consumers, simply switching off the endpoints is not an option, since this would be a breaking change for these consumers. Therefore, deprecation rules have to be applied for these endpoints, to enable consumers of these endpoints align changes in their own implementation using the APIs to non-deprecated endpoints. Deprecated endpoints can only be shut down after ensuring that the endpoint is not used anymore by any consumer.</p>
      </div>
      <div class="sect2">
        <h3 id="_deprecation_1"><span class="red">Must:</span> Obtain Approval of Clients</h3>
        <div class="paragraph">
          <p>Before shutting down an API, the version of an API or an endpoint of an API, make sure, that all clients have given their consent to this action. Helping the clients to migrate their own software to a new API or endpoint (i.e. by providing documentation or a manual) helps to accelerate this process. After all clients are migrated, the API or endpoint can safely be shut down.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_deprecation_2"><span class="red">Must:</span> External Partners Must Agree on Deprecation Timespan</h3>
        <div class="paragraph">
          <p>If the API is consumed by any external partner, a reasonable timespan must be defined, in which the deprecated API or endpoint will be maintained after announcing the deprecation. The external client must agree to this after-deprecation-lifespan before he starts using the API. In case of the deprecation of the API the external client is obligated to honor this agreement and to change his implementation (switch to a new endpoint) before end of this timespan.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_deprecation_3"><span class="red">Must:</span> Reflect Deprecation in API Definition</h3>
        <div class="paragraph">
          <p>Deprecation of an API endpoint have to be part of the openAPI definition. If a method on a path, a whole path or even a whole API endpoint (multiple paths) should be deprecated, the producers must set <span class="emphasized">deprecated=true</span> on each method / path element that will be deprecated (OpenAPI 2.0 only allows you to define deprecation on this level). If deprecation should happen on a more fine grained level (i.e. query parameter, payload etc.), the producer should set <span class="emphasized">deprecated=true</span> on the affected method / path element and add further explanation to the <span class="emphasized">description</span> section.</p>
          <p>If <span class="emphasized">deprecated</span> is set to <span class="emphasized">true</span>, the producer must describe what clients should use instead and when the API will be shut down in the <span class="emphasized">description</span> section of the API definition.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_deprecation_4"><span class="red">Must:</span> Monitor Usage of Deprecated APIs</h3>
        <div class="paragraph">
          <p>Monitoring the usage of deprecated APIs used in production helps in determining the right time the API can be shut down without running the risk of uncontrolled breaking effects. See also the <a href="#_api_operation_2"><b><span class="yellow">Should:</span> Monitor API Usage</b></a>.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_deprecation_5"><span class="yellow">Should:</span> Add a Warning Header to Responses</h3>
        <div class="paragraph">
          <p>After announcing an API as deprecated, until the API ist shut down, a <span class="emphasized">Warning</span> header (see <a href="https://tools.ietf.org/html/rfc7234#section-5.5" target="_blank">RFC 7234 - Warning header</a>) should be added to the response. When the <span class="emphasized">Warning</span> header is added, the <span class="emphasized">warn-code</span> must be <span class="emphasized">299</span> and the <span class="emphasized">warn-text</span> should be in form of <i>"The path/operation/parameter/…​ {name} is deprecated and will be removed by {date}. Please see {link} for details."</i> A link to a documentation should be added, describing why the API is no longer supported in the current form and what replacement can be used. Adding the <span class="emphasized">Warning</span> header is no replacement for obtaining client consent (see <a href="#_deprecation_1"><b><span class="red">Must:</span> Obtain Approval of Clients</b></a>).</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_deprecation_6"><span class="yellow">Should:</span> Add Monitoring for Warning Header</h3>
        <div class="paragraph">
          <p>Clients should monitor the <span class="emphasized">Warning</span> header in HTTP responses to see if an API will be deprecated in future.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_deprecation_7"><span class="red">Must Not:</span> Start Using Deprecated APIs</h3>
        <div class="paragraph">
          <p>Clients must not start using deprecated parts of an API.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_json_guidelines">8. JSON Guidelines</h2>
    <div class="sectionbody">
      <div class="paragraph">
        <p>These guidelines provide recommendations for defining JSON data at Europace. JSON here refers to <a href="https://tools.ietf.org/html/rfc7159" target="_blank">RFC 7159</a> (which updates <a href="https://tools.ietf.org/html/rfc4627" target="_blank">RFC 4627</a>), the "application/json" media type and custom JSON media types defined for APIs. The guidelines clarify some specific cases to allow Europace JSON data to have a consistent form across teams and services.</p>
      </div>
      <div class="sect2">
        <h3 id="_json_guidelines_1"><span class="red">Must:</span> Property names must be ASCII camelCase: <span class="emphasized">^[a-z_][a-z0-9]*$</span></h3>
        <div class="paragraph">
          <p>Property names are restricted to ASCII strings. The first character must be a letter, or an underscore, and subsequent characters can be a letter, or a number.</p>
          <p>(It is recommended to use <span class="emphasized">_</span> at the start of property names only for keywords like <span class="emphasized">_links</span>.) </p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_json_guidelines_2"><span class="red">Must Not:</span> Define Maps Using <span class="emphasized">additionalProperties</span></h3>
        <div class="paragraph">
          <p>Properties must always be named in a way that consumers know which kind of data is contained in these property fields. To avoid producing breaking changes by introducing a new property, properties can be marked as optional and has to be handled as such. We strongly discourage usage of a non-descriptive generic such as additionalProperties.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_json_guidelines_3"><span class="yellow">Should:</span> Array names should be pluralized</h3>
        <div class="paragraph">
          <p>To indicate they contain multiple values prefer to pluralize array names. This implies that object names should in turn be singular.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_json_guidelines_4"><span class="green">May:</span> Boolean property values may be null</h3>
        <div class="paragraph">
          <p>If useful for the purpose of a boolean property in a JSON resource, the property may allow null values to present an additional meaning besides <b>true</b> and <b>false</b>, as is:</p>
          <ul>
            <li>no value, irrelevant</li>
          </ul>
          <p>This can also make sense i.e. if boolean property settings should be inherited from parent resources.</p>
          <p>However, we strongly discourage using a boolean value set to null to be defaulted to either <b>true</b> or <b>false</b>. Behavior like this might lead to misunderstandings and wrong usage of the property. If always a value is expected for a boolean property, prefer not allowing null values for the property, i.g. mark the property as required.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_json_guidelines_5"><span class="yellow">Should:</span> Null values should have their fields removed</h3>
        <div class="paragraph">
          <p>OpenAPI does not support null field values. Instead it supports omitting a field completely if the value is null and the field is not marked as required. Clients and servers still can send and receive those fields with null values. In some cases null may be a meaningful value - for example, JSON Merge Patch <a href="https://tools.ietf.org/html/rfc7396" target="_blank">RFC 7396</a>) using null to indicate property deletion. Therefore this paragraph is marked as <b class="yellow">Should</b>. As API provider always carefully consider the purpose of a null value field before adding it to the API response.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_json_guidelines_6"><span class="yellow">Should:</span> Empty array values should not be null</h3>
        <div class="paragraph">
          <p>Empty array values can unambiguously be represented as the empty list, <span class="emphasized">[]</span>. Empty lists instead of null reduce complexity in processing payload or API response.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_json_guidelines_7"><span class="yellow">Should:</span> Enumerations should be represented as Strings</h3>
        <div class="paragraph">
          <p>Strings are a reasonable target for values that are by design enumerations. The string value representation of an enumeration is a lot more readable than the ordinal representation and also more failsafe if the enumeration is changed (added values, removed values). Representation as a string also enables the consumer to implement his own solution in processing the field value. Enumerations likely to change often should be handled by the API as string values instead of enumeration values to allow for simple, non-breaking evolution of the field values.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_json_guidelines_8"><span class="red">Must:</span> Date property values must conform to ISO 8601</h3>
        <div class="paragraph">
          <p>Use the date and time formats defined by <a href="https://en.wikipedia.org/wiki/ISO_8601" target="_blank">ISO 8601</a>:</p>
          <ul>
            <li>for "date" use strings matching <span class="emphasized">date-fullyear "-" date-month "-" date-mday</span>, for example: <span class="emphasized">2015-05-28</span></li>
            <li>for "date-time" use strings matching <span class="emphasized">full-date "T" full-time</span>, for example <span class="emphasized">2015-05-28T14:07:17Z</span></li>
          </ul>
          <p>A zone offset may be used (both, in request and responses) — this is simply defined by the standards. We encourage allowing all date-time formats listed in <a href="https://en.wikipedia.org/wiki/ISO_8601" target="_blank">ISO 8601</a> for request parameters, including UTC format and formats with zone offset. For API payload and response JSON we encourage using date-time format with zone offset, to be able to use German timezone (for which the APIs are created) for requests and response processing.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_json_guidelines_9"><span class="yellow">Should:</span> Time durations and intervals could conform to ISO 8601</h3>
        <div class="paragraph">
          <p>Schema based JSON properties that are by design durations and intervals should be strings formatted as recommended by <a href="https://en.wikipedia.org/wiki/ISO_8601" target="_blank">ISO 8601</a> (<a href="https://tools.ietf.org/html/rfc3339#appendix-A" target="_blank">Appendix A of RFC 3339 contains a grammar</a> for durations).</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_json_guidelines_10"><span class="yellow">Should:</span> Standards could be used for Language, Country and Currency</h3>
        <div class="paragraph">
          <ul>
            <li><a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2" target="_blank">ISO 3166-1-alpha2 country</a></li>
            <li><a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes" target="_blank">ISO 639-1 language code</a></li>
            <li><a href="https://tools.ietf.org/html/bcp47" target="_blank">BCP-47</a> (based on <a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes" target="_blank">ISO 639-1</a>) for language variants</li>
            <li><a href="https://en.wikipedia.org/wiki/ISO_4217" target="_blank">ISO 4217 currency codes</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_naming">9. Naming</h2>
    <div class="sectionbody">
      <div class="sect2">
        <h3 id="_naming_1"><span class="red">Must:</span> Use lowercase separate words with hyphens for Path Segments</h3>
        <div class="paragraph">
          <p>This applies to concrete path segments and not the names of path parameters. For example <span class="emphasized">{antragsNummer}</span> would be ok as a path parameter.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_naming_2"><span class="red">Must:</span> Use camelCase for Query Parameters</h3>
        <div class="paragraph">
          <p>Examples:</p>
          <p class="preformatted-custom"><code>vorgangsNummer, antragsNummer, teilAntragId</code></p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_naming_3"><span class="yellow">Should:</span> Prefer Hyphenated-Pascal-Case for HTTP header Fields</h3>
        <div class="paragraph">
          <p>This is for consistency in your documentation (most other headers follow this convention). Avoid camelCase (without hyphens).</p>
          <p>Examples:</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              Accept-Encoding<br/>
              Apply-To-Redirect-Ref<br/>
              Disposition-Notification-Options<br/>
              Original-Message-ID
            </code>
          </p>
          <p>See also: <a href="https://tools.ietf.org/html/rfc7230#page-22" target="_blank">HTTP Headers are case-insensitive (RFC 7230)</a>.</p>
          <p>Exceptions are commonly Europace-wide used headers like <span class="emphasized">X-TraceId</span>, for compatibility reasons.</p>
          <p>See <a href="#_common_headers">Common Headers</a> and <a href="#_proprietary_headers">Proprietary Headers</a> sections for more guidance on HTTP headers.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_naming_4"><span class="red">Must:</span> Pluralize Resource Names</h3>
        <div class="paragraph">
          <p>Usually, a collection of resource instances is provided (at least API should be ready here). The special case of a resource singleton is a collection with cardinality 1.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_naming_5"><span class="yellow">Should:</span> Not Use /api as Base Path</h3>
        <div class="paragraph">
          <p>We strongly recommend not using <b>/api</b> as base path for your API.</p>
          <p>Usually, all resources provided by a service are part of the public API. They should be made available under the root “/” base path.</p>
          <p>If a service also supports non-public, private API, we recommend providing a separate API.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_naming_6"><span class="yellow">Should Not:</span> Use Trailing Slashes in Resource Path</h3>
        <div class="paragraph">
          <p>The trailing slash should not have specific semantics. Resource paths must deliver the same results whether they have the trailing slash or not.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_naming_7"><span class="red">Must:</span> Stick to Conventional Query Parameters</h3>
        <div class="paragraph">
          <p>If you provide query support for searching, sorting, filtering, and paginating, you must stick to the following naming conventions:</p>
          <ul>
            <li><span class="emphasized">sort</span> — order in which results are sorted, one of the values “aufsteigend/ascending” or “absteigend/descending” (case-insensitive)</li>
            <li><span class="emphasized">page</span> — page of result to be returned (makes sense in combination with (defaulted) limit parameter). See <a href="#_pagination">Pagination</a> section.</li>
            <li><span class="emphasized">limit</span> — number of entries in one  result page (in combination with page parameter (usually with default value=1). See <a href="#_pagination">Pagination</a> section.</li>
            <li><span class="emphasized">fields</span> — to retrieve only a subset of fields of a resource. See <a href="#_performance_3"><b><span class="yellow">Should:</span> Support Partial Responses via Filtering</b></a> section.</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_resources">10. Resources</h2>
    <div class="sectionbody">
      <div class="sect2">
        <h3 id="_resources_1"><span class="red">Must:</span> Avoid Actions — Think About Resources</h3>
        <div class="paragraph">
          <p>REST is about resources. Consider the domain entities taking part in the purposed web service interaction as resources and aim to model your API around these using standard HTTP methods (GET, POST, PUT…) as operation descriptors. For instance, if an application has to change the status of a BaufiSmart Antrag, create a model change with <a href="#_http_method_put"><span class="emphasized">PUT</span></a> or <a href="#_http_method_post"><span class="emphasized">POST</span></a> instead of using a “change status” action.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_resources_2"><span class="yellow">Should:</span> Model complete business processes</h3>
        <div class="paragraph">
          <p>An API should contain the complete business process, including all resources used in the process. This has a lot of advantages:</p>
          <ul>
            <li>it enables clients to understand the business process behind</li>
            <li>allows for synergies between description and implementation perspectives</li>
            <li>eliminates implicit and perhaps even invisible dependencies between APIs</li>
          </ul>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_resources_3"><span class="yellow">Should:</span> Define resources to meet clients requirements</h3>
        <div class="paragraph">
          <p>Resources should be defined to cover ca. 90% of all client’s use cases. A sensible resource design should contain as much information as necessary, but as little as possible. You should design your APIs in a way that a client can get the data he needs in at most two API calls. To support the last 10% is to allow clients to specify their needs for more/less information by supporting filtering and embedding.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_resources_4"><span class="red">Must:</span> Keep URLs Verb-Free</h3>
        <div class="paragraph">
          <p>When your API describes resources (see <a href="#_resources_1"><b><span class="red">Must:</span> Avoid Actions - Think About Resources</b></a>), the only place where actions should appear is in the HTTP methods. In URLs only use nouns. To help wording your path, do not think in actions (e.g. changeStatus), but instead of putting a message in a box on the server side (e.g. statusChanges). This is also very helpful when designing asynchronous running API services.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_resources_5"><span class="red">Must:</span> Use Domain-Specific Resource Names</h3>
        <div class="paragraph">
          <p>API resources represent elements of the application’s domain model. Using domain-specific resource names</p>
          <ul>
            <li>helps developers to understand the functionality and semantics of the resources.</li>
            <li>reduces the need for further documentation outside of the API definition.</li>
          </ul>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_resources_6"><span class="red">Must:</span> Use URL-friendly Resource Identifiers: <span class="emphasized">[a-zA-Z0-9/:._-]*</span></h3>
        <div class="paragraph">
          <p>Use only ASCII strings of letters and numbers, if necessary slash, underscore, hyphen, colon or period in IDs representing resources. This simplifies encoding of these IDs if used as part of URL paths.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_resources_7"><span class="red">Must:</span> Identify resources and Sub-Resources via Path Segments</h3>
        <div class="paragraph">
          <p>API resources can contain or reference sub-resources. Sub-resources, which are not top-level resources, are part of a higher-level resource. they cannot be used outside of their scope. For intuitive handling, sub-resources should be referenced bay their name and identifier in the path segments.</p>
          <p>As Europace is using / as separator in its business entity identifiers (e.g. Antragsnummer AB123/1/1), composite identifiers can contain / as a separator. For our business cases this enables intuitive URL paths for resources and sub-resources.</p>
          <p>Basic URL structure:</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              /antraege<br/>
              /antraege/{vorgang}<br/>
              /antraege/{vorgang}/{antrag}<br/>
              /antraege/{vorgang}/{antrag}/angebot<br/>
              /antraege/{vorgang}/{antrag}/{teilantrag}<br/>
              /antraege/{vorgang}/{antrag}/{teilantrag}/status<br/>
              ...
            </code>
          </p>
          <p>Examples:</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              /antraege<br/>
              /antraege/AB123<br/>
              /antraege/AB123/1<br/>
              /antraege/AB123/1/angebot<br/>
              /antraege/AB123/1/1<br/>
              /antraege/AB123/1/1/status<br/>
              ...
            </code>
          </p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_resources_8"><span class="yellow">Should Not:</span> Consider Using (Non-) Nested URLs</h3>
        <div class="paragraph">
          <p>If a sub-resource is only accessible via its parent resource and may not exists without parent resource, use a nested URL structure, for instance:</p>
          <p class="preformatted-custom"><code>/antraege/AB123/1/1</code></p>
          <p>A Teilantrag from a Vorgang could also be accessed via its unique object id and exposed as top-level resource. As the object id of these sub resources is only used internally and usually not exposed publicly, we discourage providing API endpoints using these ids. A sub-resource should always be referred to by its nested identifier.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_resources_9"><span class="yellow">Should:</span> Limit number of Resource types</h3>
        <div class="paragraph">
          <p>Follow “functional segmentation” and “separation of concern” design principles to keep API maintenance and evolution manageable. Do not mix different business functions in the same API definition. Practically, limit the number of resource types exposed via an API. In this context a resource type is defined as a set of highly related resources such as a collection, its members and any direct sub-resources.</p>
          <p>For example, the resources below would be counted as two resource types, one for Vorgänge, and one for the Vorgänge’s related Anträge:</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              /vorgaenge<br/>
              /vorgaenge/{vorgangsNummer}<br/>
              /vorgaenge/{vorgangsNummer}/kundenbetreuer<br/>
              /vorgaenge/{vorgangsNummer}/antraege<br/>
              /vorgaenge/{vorgangsNummer}/antraege/{antragsNummer}
            </code>
          </p>
          <p>Note that:</p>
          <ul>
            <li>We consider <code>/vorgaenge/{vorgangsNummer}/kundenbetreuer</code> part of the <code>/vorgaenge</code> resource type because it has a one-to-one relation to the customer without an additional identifier.</li>
            <li>We consider <code>/vorgaenge</code> and <code>/vorgaenge/{vorgangsNummer}/antraege</code> as separate resource types.</li>
          </ul>
          <p>With this definition, well defined APIs usually involve only a handful of resource types. There may be exceptions with more complex business domains that require more resources, but you should check first if you can split them into separate subdomains with distinct APIs.</p>
          <p>Nevertheless one API should hold all necessary resources to model complete business processes. This helps clients to understand the flows.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_resources_10"><span class="yellow">Should:</span> Limit number of Sub-Resource Levels</h3>
        <div class="paragraph">
          <p>There are main resources (with root url paths) and sub-resources (or nested resources with non-root urls paths). Sub-resources should be used if their life cycle is coupled in any way to the main resource. You should limit the count of sub-resource nesting level,we suggest not more than 3 levels. More levels increase the complexity and the URL path length unnecessarily.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_http_requests">11. HTTP Requests</h2>
    <div class="sectionbody">
      <div class="sect2">
        <h3 id="_http_requests_1"><span class="red">Must:</span> Use HTTP Methods Correctly</h3>
        <div class="paragraph">
          <p>Be compliant with the standardized HTTP method semantics summarized as follows:</p>
          <h4 id="_http_method_get">GET</h4>
          <p><span class="emphasized">GET</span> requests are used to <b>read</b> either a single or a collection resource.</p>
          <ul>
            <li><span class="emphasized">GET</span> requests for individual resources will usually generate a <a href="#_status_code_404"><span class="emphasized">404</span></a> if the resource does not exist</li>
            <li><span class="emphasized">GET</span> requests for collection resources may return either <a href="#_status_code_200"><span class="emphasized">200</span></a> (if the collection is empty) or <a href="#_status_code_404"><span class="emphasized">404</span></a> (if the collection is missing)</li>
            <li><span class="emphasized">GET</span> requests must NOT have a request body payload</li>
          </ul>
          <p><b>Note:</b> <span class="emphasized">GET</span> requests on collection resources should provide sufficient <a href="#_naming_7">filter</a> and <a href="#_pagination">pagination</a> mechanisms.</p>
          <p>Sometimes APIs face the problem that they have to provide extensive structured request information with <span class="emphasized">GET</span>. That may conflict with the size limits of clients, load-balancers, and servers. To handle these cases without breaking standard conformity (body in <span class="emphasized">GET</span> must be ignored on server side), consider following one of two options for your API design:</p>
          <ol>
            <li><span class="emphasized">GET</span> with URL encoded query parameters: when it is possible to encode the request information in query parameters, respecting the usual size limits of clients, gateways, and servers, this should be the first choice. Request information can be provided distributed to multiple query parameters if the size limits are met, or a single structured URL encoded string can be used to reduce length.</li>
            <li><a href="#_http_method_post"><span class="emphasized">POST</span></a> with body content: when a <span class="emphasized">GET</span> with URL encoded query parameters is not possible, a <a href="#_http_method_post"><span class="emphasized">POST</span></a> with body content must be used. In this case use standard <a href="#_http_method_post"><span class="emphasized">POST</span></a> request and return status code <a href="#_status_code_302"><span class="emphasized">302</span></a> to redirect to target (<span class="emphasized">GET</span>) URL.</li>
          </ol>
          <p><b>Note:</b> Do not encode the lengthy structured request information in header parameters. The semantic of an operation should always be expressed in resource names and query parameters. Request headers are reserved for general context information, e.g. authorization tokens or trace ids. Size limits on headers are not reliable anyway and depend on clients, gateways, server, and actual settings. Encoding the request information in header parameters does therefore not solve the original problem.</p>
          <h4 id="_http_method_put">PUT</h4>
          <p><span class="emphasized">PUT</span> requests can be used to <b>update</b> (or in few cases to create) <b>entire</b> resources – single or collection. The semantic is best described as <i>"please put the enclosed representation at the resource mentioned by the URL, replacing any existing resource."</i>.</p>
          <ul>
            <li><span class="emphasized">PUT</span> requests are usually applied to single resources, and not to collection resources. Using <span class="emphasized">PUT</span> to update collection resources would imply replacing the entire collection.</li>
            <li><span class="emphasized">PUT</span> requests are usually robust against non-existence of resources by implicitly creating before updating. Keep in mind, that API design and implementation honour this requirement when using <span class="emphasized">PUT</span> in this context.</li>
            <li>on successful <span class="emphasized">PUT</span> requests, the server will <b>replace the entire resource</b> addressed by the URL with the representation passed in the payload (subsequent reads will deliver the same payload). This means using PUT the whole resource has to be loaded, even if only one field has changed.</li>
            <li>successful <span class="emphasized">PUT</span> requests will usually generate <a href="#_status_code_200"><span class="emphasized">200</span></a> or <a href="#_status_code_204"><span class="emphasized">204</span></a> (if the resource was updated – with or without actual content returned), and <a href="#_status_code_201"><span class="emphasized">201</span></a> (if the resource was created)</li>
          </ul>
          <p><b>Important:</b> We strongly recommend using <a href="#_http_method_post"><span class="emphasized">POST</span></a> over <span class="emphasized">PUT</span> for creation of resources and <a href="#_http_method_patch"><span class="emphasized">PATCH</span></a> over <span class="emphasized">PUT</span> for resource updates.</p>
          <ul>
            <li>Using <a href="#_http_method_post"><span class="emphasized">POST</span></a> for creation leaves the resource ID under control of the service</li>
            <li>Using <a href="#_http_method_patch"><span class="emphasized">PATCH</span></a> for update enables the client to only send the fields actually changed in the resource instead of the entire resource needed in a <span class="emphasized">PUT</span> request, thus reducing payload considerably.</li>
          </ul>
          <h4 id="_http_method_post">POST</h4>
          <p><span class="emphasized">POST</span> requests are used to <b>create</b> single resources on a collection resource endpoint, but other semantics on single resources endpoint are equally possible. The semantic for collection endpoints is best described as <i>"please add the enclosed representation to the collection resource identified by the URL"</i>.</p>
          <ul>
            <li>on a successful <span class="emphasized">POST</span> request, the server will create one or multiple new resources and provide their URI/URLs in the response</li>
            <li>successful <span class="emphasized">POST</span> requests will usually generate <a href="#_status_code_200"><span class="emphasized">200</span></a> (if resources have been updated), <a href="#_status_code_201"><span class="emphasized">201</span></a> (if resources have been created), <a href="#_status_code_202"><span class="emphasized">202</span></a> (if the request was accepted but has not been finished yet), and exceptionally <a href="#_status_code_204"><span class="emphasized">204</span></a> with Location header (if the actual resource is not returned).</li>
          </ul>
          <p>The semantic for single resource endpoints is best described as <i>"please execute the given well specified request on the resource identified by the URL"</i>.</p>
          <p><b>Note:</b> Resource IDs with respect to <span class="emphasized">POST</span> requests are created and maintained by server and returned with response payload.</p>
          <p><b>Hint:</b> Posting the same resource twice is <b>not</b> required to be idempotent and may result in multiple resources. Since there is no possibility to identify a resource to be created unambiguously in the Europace platform, <span class="emphasized">POST</span> calls in an Europace API are explicitly not required to be idempotent and will result in multiple resources when called more than once for the same resource.</p>
          <h4 id="_http_method_patch">PATCH</h4>
          <p><span class="emphasized">PATCH</span> requests are used to <b>update parts</b> of single resources, i.e. where only a specific subset of resource fields should be modified. The semantic is best described as <i>"please change the resource identified by the URL according to my change request"</i>. The semantic of the change request is not defined in the HTTP standard and must be described in the API specification by using suitable media types.</p>
          <ul>
            <li><span class="emphasized">PATCH</span> requests are usually applied to single resources as patching entire collection is challenging</li>
            <li><span class="emphasized">PATCH</span> requests are usually not robust against non-existence of resource instances</li>
            <li>on successful <span class="emphasized">PATCH</span> requests, the server will update parts of the resource addressed by the URL as defined by the change request in the payload</li>
            <li>successful <span class="emphasized">PATCH</span> requests will usually generate <a href="#_status_code_200"><span class="emphasized">200</span></a> or <a href="#_status_code_204"><span class="emphasized">204</span></a> (if resources have been updated with or without updated content returned)</li>
          </ul>
          <p><b>Note:</b> since implementing <span class="emphasized">PATCH</span> correctly is a bit tricky, we strongly suggest to implement the following pattern, unless forced by a backwards compatible change:</p>
          <ul>
            <li>use <span class="emphasized">PATCH</span> with <a href="https://tools.ietf.org/html/rfc6902" target="_blank">JSON Patch</a>, a specialized media type <span class="emphasized">application/json-patch+json</span> that includes instructions on how to change the resource.</li>
          </ul>
          <p><b>Note:</b> Patching the same resource twice is <b>not</b> required to be idempotent (check <a href="#_http_requests_2"><b><span class="red">Must:</span> Fulfill Common Method Properties</b></a>) and may result in a changing result. However, you <a href="#_http_requests_3"><b><span class="yellow">Should:</span> Consider To Design <span class="emphasized">PATCH</span> Idempotent</b></a> to prevent this.</p>
          <p><b>Hint:</b> To prevent unnoticed concurrent updates when using <span class="emphasized">PATCH</span> you <a href="#_common_headers_5"><b><span class="green">May:</span> Consider to Support <span class="emphasized">ETag</span> Together With <span class="emphasized">If-Match</span>/<span class="emphasized">If-None-Match</span> Header</b></a> to allow the server to react on stricter demands that expose conflicts and prevent lost updates. See <a href="#_http_requests_3"><b><span class="yellow">Should:</span> Consider To Design <span class="emphasized">PATCH</span> Idempotent</b></a> for details and options.</p>
          <h4 id="_http_method_delete">DELETE</h4>
          <p><span class="emphasized">DELETE</span> requests are used to delete resources. The semantic is best described as <i>"please delete the resource identified by the URL"</i>.</p>
          <ul>
            <li><span class="emphasized">DELETE</span> requests are usually applied to single resources, not on collection resources, as this would imply deleting the entire collection</li>
            <li>successful <span class="emphasized">DELETE</span> requests will usually generate <a href="#_status_code_200"><span class="emphasized">200</span></a> (if the deleted resource is returned) or <a href="#_status_code_204"><span class="emphasized">204</span></a> (if no content is returned)</li>
            <li>failed <span class="emphasized">DELETE</span> requests will usually generate <a href="#_status_code_404"><span class="emphasized">404</span></a> (if the resource cannot be found) or <a href="#_status_code_410"><span class="emphasized">410</span></a> (if the resource was already deleted before)</li>
          </ul>
          <p><b>Important:</b> After deleting a resource with <span class="emphasized">DELETE</span>, a <a href="#_http_method_get"><span class="emphasized">GET</span></a> request on the resource is expected to either return <a href="#_status_code_404"><span class="emphasized">404</span></a> (not found) or <a href="#_status_code_410"><span class="emphasized">410</span></a> (gone) depending on how the resource is represented after deletion. After deletion a resource must never be accessible via an API endpoint.</p>
          <h4 id="_http_method_head">HEAD</h4>
          <p><span class="emphasized">HEAD</span> requests are used to <b>retrieve</b> the header information of single resources and resource collections.</p>
          <ul>
            <li><span class="emphasized">HEAD</span> has exactly the same semantics as <a href="#_http_method_get"><span class="emphasized">GET</span></a>, but returns headers only, no body.</li>
          </ul>
          <p><b>Hint:</b> <span class="emphasized">HEAD</span> is particularly useful to efficiently lookup whether large resources or collection resources exist and/or have been updated in conjunction with the <span class="emphasized">ETag</span>-header.</p>
          <h4 id="_http_method_options">OPTIONS</h4>
          <p><span class="emphasized">OPTIONS</span> requests are used to <b>inspect</b> the available operations (HTTP methods) of a given endpoint.</p>
          <ul>
            <li><span class="emphasized">OPTIONS</span> responses should either return a comma separated list of methods in the <span class="emphasized">Allow</span> header or a structured list of link templates</li>
          </ul>
          <p><b>Note:</b> <span class="emphasized">OPTIONS</span> is rarely implemented, though it could be used to self-describe the full functionality of a resource.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_http_requests_2"><span class="red">Must:</span> Fulfill Common Method Properties</h3>
        <div class="paragraph">
          <p>Request methods in RESTful services can be…​</p>
          <ul>
            <li><a href="https://tools.ietf.org/html/rfc7231#section-4.2.1" target="_blank">safe</a> - the operation semantic is defined to be read-only, that means it must not have intended side effects, i.e. changes, to the server state.</li>
            <li><a href="https://tools.ietf.org/html/rfc7231#section-4.2.2" target="_blank">idempotent</a> - the operation has the same intended effect on the server state, independently whether it is executed one or multiple times. Note: this does not require that the operation is returning the same response or status code.</li>
            <li><a href="https://tools.ietf.org/html/rfc7231#section-4.2.3" target="_blank">cacheable</a> - the operation is allowed to store responses for future reuse. Usually, requests to safe methods are cacheable, if it does not require a current or authoritative response from the server.</li>
          </ul>
          <p><b>Note:</b> The above definitions, of <i>intended (side) effect</i> allows the server to provide additional state changing behavior as logging/auditing, accounting, pre- fetching, etc. However, these additional state changes must not be intended by the operation as part of the business process to the operation can be held accountable.</p>
          <p>Method implementations must fulfill the following basic properties according to <a href="https://tools.ietf.org/html/rfc7231" target="_blank">RFC 7231</a>:</p>
          <table class="tableblock frame-all grid-all spread">
            <thead>
            <tr>
              <th class="tableblock halign-left valign-middle">Method</th>
              <th class="tableblock halign-left valign-middle">Safe</th>
              <th class="tableblock halign-left valign-middle">Idempotent</th>
              <th class="tableblock halign-left valign-middle">Cacheable</th>
            </tr>
            </thead>
            <tbody>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><a href="#_http_method_get"><span class="emphasized">GET</span></a></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" style="white-space: nowrap"><span class="fas fa-check"></span>Yes</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-check"></span>Yes</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-check"></span>Yes</p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><a href="#_http_method_head"><span class="emphasized">HEAD</span></a></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-check"></span>Yes</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-check"></span>Yes</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-check"></span>Yes</p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><a href="#_http_method_post"><span class="emphasized">POST</span></a></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-times"></span>No</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-times"></span>No</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-exclamation-triangle"></span><span class="fas fa-check"></span>May, but only if specific <span class="emphasized">POST</span> endpoint is safe <b>Hint:</b> not supported by most chaches</p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><a href="#_http_method_put"><span class="emphasized">PUT</span></a></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-times"></span>No</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-check"></span>Yes</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-times"></span>No</p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><a href="#_http_method_patch"><span class="emphasized">PATCH</span></a></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-times"></span>No</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-exclamation-triangle"></span><span class="fas fa-times"></span>No, but <a href="#_http_requests_3"><b><span class="yellow">Should:</span> Consider To Design <span class="emphasized">PATCH</span> Idempotent</b></a></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-times"></span>No</p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><a href="#_http_method_delete"><span class="emphasized">DELETE</span></a></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-times"></span>No</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-check"></span>Yes</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-times"></span>No</p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><a href="#_http_method_options"><span class="emphasized">OPTIONS</span></a></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-check"></span>Yes</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-check"></span>Yes</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-times"></span>No</p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">TRACE</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-check"></span>Yes</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-check"></span>Yes</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="fas fa-times"></span>No</p>
                </td>
              </tr>
            </tbody>
          </table>
          <p><b>Note: <a href="#_performance_4"><span class="red">Must:</span> Document Cacheable GET, HEAD, and POST Endpoints</a></b>.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_http_requests_3"><span class="yellow">Should:</span> Consider To Design <span class="emphasized">PATCH</span> Idempotent</h3>
        <div class="paragraph">
          <p>In many cases it is helpful or even necessary to design <a href="#_http_method_patch"><span class="emphasized">PATCH</span></a> idempotent for clients to expose conflicts and prevent lost updates, e.g. if same resources may be changed in parallel or multiple times. Europace does not request creation of resources (<a href="#_http_method_post"><span class="emphasized">POST</span></a>) to be idempotent, so secondary keys or similar to identify resources unambiguously are unnecessary. To design an idempotent <a href="#_http_method_patch"><span class="emphasized">PATCH</span></a> API endpoint, a primary resource identifier is considered best practice, i.e. Vorgangsnummer.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_http_requests_4"><span class="yellow">Should:</span> Define Collection Format of Query Parameters and Headers</h3>
        <div class="paragraph">
          <p>If query parameters and headers allow to provide a list of values, this is done either by providing a comma-separated list (<span class="emphasized">csv</span>) or by repeating the parameter multiple times with different values (<span class="emphasized">multi</span>). The API specification should explicitly define one type as follows:</p>
          <table class="tableblock frame-all grid-all spread">
            <thead>
            <tr>
              <th class="tableblock halign-left valign-middle">Description</th>
              <th class="tableblock halign-left valign-middle">OpenAPI 2.0</th>
              <th class="tableblock halign-left valign-middle">OpenAPI 3.0</th>
              <th class="tableblock halign-left valign-middle">Example</th>
            </tr>
            </thead>
            <tbody>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Comma separated values</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><code>collectionFormat: csv</code></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><code>style: form, explode: false</code></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><code>?param=value1,value2</code></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Multiple parameters</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><code>collectionFormat: multi</code></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><code>style: form, explode: true</code></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><code>?param=value1&amp;param=value2</code></p>
                </td>
              </tr>
            </tbody>
          </table>
          <p>When deciding on the preferred collection format, think about tool support, special character escaping and maximal URL length.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_http_requests_5"><span class="red">Must:</span> Document Implicit Filtering</h3>
        <div class="paragraph">
          <p>Clients do only get access to resources they are authorized for. Usually this will be a subset of the resources available in the system.</p>
          <p>Implicit filtering could be done on:</p>
          <ul>
            <li>the resource types delivered by an API endpoint</li>
            <li>the collection of resources of a specific type delivered by a <a href="#_http_method_get"><span class="emphasized">GET</span></a> request</li>
            <li>the fields returned for the resource’s detail</li>
          </ul>
          <p>Creation and update of resources might equally be restricted by client authorization</p>
          <ul>
            <li>the type of resources a client may create/update/delete</li>
            <li>the collection of resources of a specific type, the client may update/delete</li>
            <li>the fields in a specific resource or resource type the client may modify</li>
          </ul>
          <p>In such cases, the implicit filtering must be in the API specification (in its description).</p>
          <p>When implicit filtering is part of the API design take caching considerations into account.</p>
          <p>Example:</p>
          <p>If the Anträge-API is requested by a client of “Bank A” to display the Anträge managed by an employee (i.e. a “Kreditsachbearbeiter”) of the institution, it must, for legal reasons, only display the Anträge of “Bank A”, it must not display Anträge of, e.g. “Bank B”.</p>
          <p>The API Specification should then specify something like this:</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              <span class="purple">paths:</span>:<br/>
              <span class="purple" style="padding-left: 1em;">/antraege</span>:<br/>
              <span class="purple" style="padding-left: 2em;">get</span>:<br/>
              <span class="purple" style="padding-left: 3em;">description</span>: <span class="red">&gt;-</span><br/>
              <span class="red" style="padding-left: 4em;">Get the list of Anträge of the requesting client. Only the Anträge to which the requesting client has access are returned.</span>
            </code>
          </p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_http_status_codes">12. HTTP Status Codes And Errors</h2>
    <div class="sectionbody">
      <div class="sect2">
        <h3 id="_http_status_codes_1"><span class="red">Must:</span> Specify Success and Error Responses</h3>
        <div class="paragraph">
          <p>API definitions should consist in a functional view on the business processes. They should abstract from implementation details.</p>
          <p>To define correct usage of an API, success and error responses are vital parts of an API specification.</p>
          <p><b>All</b> service success and error responses must be defined in your API specification. They belong to the interface definition and provide important information for service clients to handle standard as well as exceptional situations.</p>
          <p><b>Hint:</b> In most cases documentation of all technical errors is not useful, especially if the service provider has no control over them. As long as a response code does not convey application-specific semantics or is used in a none-standard way (which should be avoided in any case) requiring additional explanation, a list of  error response specifications can be combined using the following pattern (see also <a href="#_general_3"><b><span class="red">Must:</span> only use Durable and Immutable Remote References</b></a>):</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              <span class="purple">responses</span>:<br/>
              <span class="purple" style="padding-left: 1em;">...</span><br/>
              <span class="purple" style="padding-left: 1em;">default</span>:<br/>
              <span class="purple" style="padding-left: 2em;">description</span>: <span class="red">error occurred - see status code and problem object for more information.</span><br/>
              <span class="purple" style="padding-left: 2em;">content</span>:<br/>
              <span class="purple" style="padding-left: 3em;">"application/problem+json"</span>:<br/>
              <span class="purple" style="padding-left: 4em;">schema</span>:<br/>
              <span class="purple" style="padding-left: 5em;">$ref</span>:<span class="red">'https://<i>link einfügen</i>/problem/schema.yaml#/Problem'</span>
            </code>
          </p>
          <p><b>Hint:</b> A <b>troubleshooting board</b> as part of the associated online API documentation can be a good way to provide detailed information and handling advice on application-specific errors. It can be referenced via links from the API specification (see <a href="#_general_3"><b><span class="red">Must:</span> only use Durable and Immutable Remote References</b></a> again). Using this measure can reduce service support tasks and contribute to service client and provider performance.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_http_status_codes_2"><span class="red">Must:</span> Use Standard HTTP Status Codes</h3>
        <div class="paragraph">
          <ul>
            <li>You must only use standardized HTTP status codes.</li>
            <li>You must use them consistently with their intended semantics.</li>
            <li>You must not invent new HTTP status codes.</li>
          </ul>
          <p>RFC standards define ~60 different HTTP status codes with specific semantics (mainly <a href="https://tools.ietf.org/html/rfc7231#section-6" target="_blank">RFC7231</a> and <a href="https://tools.ietf.org/html/rfc6585" target="_blank">RFC 6585</a>) — and there are upcoming new ones, e.g. <a href="https://tools.ietf.org/html/draft-tbray-http-legally-restricted-status-05" target="_blank">draft legally-restricted-status</a>. An overview of all HTTP status codes can be found on <a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes" target="_blank">Wikipedia</a> (includes also ‘unofficial codes, e.g. used by popular web servers like Nginx) or via <a href="https://httpstatuses.com" target="_blank">https://httpstatuses.com</a> (only official codes).</p>
          <p>Below the most commonly used HTTP status codes are listed, describing also their semantics in the RFCs. Whenever possible, APIs should always prefer a more common status code to a less commonly used status code, to avoid misconceptions of an API response.</p>
          <p><b>Important:</b> When the returned HTTP status code usage is well covered by the semantic of the status code definition, do not describe it in your API specification specially. This avoids overload with common sense information and minimizes the risk of inconsistent definitions. You should avoid using an HTTP status code with a different semantic than the one described in the common status code definition. Only if the HTTP status code is not in the list below or its usage requires necessarily additional information aside the well defined semantic, the API specification must provide a clear description of the HTTP status code in the response.</p>
          <h4 id="_success_codes">Success Codes</h4>
          <table class="tableblock frame-all grid-all spread">
            <thead>
            <tr>
              <th class="tableblock halign-left valign-middle">Code</th>
              <th class="tableblock halign-left valign-middle">Meaning</th>
              <th class="tableblock halign-left valign-middle">Methods</th>
            </tr>
            </thead>
            <tbody>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_200"><span class="emphasized">200</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">OK - this is the standard success response</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_201"><span class="emphasized">201</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Created - Returned on successful entity creation. You are free to return either an empty response or the created resource in conjunction with the Location header. (More details found in the <a href="#_common_headers">Common Headers</a>.) Always set the Location header.</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><a href="#_http_method_post"><span class="emphasized">POST</span></a>, <a href="#_http_method_patch"><span class="emphasized">PATCH</span></a></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_202"><span class="emphasized">202</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Accepted - The request was successful and will be processed asynchronously.</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><a href="#_http_method_post"><span class="emphasized">POST</span></a>, <a href="#_http_method_put"><span class="emphasized">PUT</span></a>, <a href="#_http_method_patch"><span class="emphasized">PATCH</span></a>, <a href="#_http_method_delete"><span class="emphasized">DELETE</span></a></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_204"><span class="emphasized">204</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">No content - There is no response body.</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><a href="#_http_method_put"><span class="emphasized">PUT</span></a>, <a href="#_http_method_patch"><span class="emphasized">PATCH</span></a>, <a href="#_http_method_delete"><span class="emphasized">DELETE</span></a></p>
                </td>
              </tr>
            </tbody>
          </table>
          <h4 id="_redirection_codes">Redirection Codes</h4>
          <table class="tableblock frame-all grid-all spread">
            <thead>
            <tr>
              <th class="tableblock halign-left valign-middle">Code</th>
              <th class="tableblock halign-left valign-middle">Meaning</th>
              <th class="tableblock halign-left valign-middle">Methods</th>
            </tr>
            </thead>
            <tbody>
            <tr>
              <td class="tableblock halign-left valign-middle">
                <p class="tableblock" id="_status_code_301"><span class="emphasized">301</span></p>
              </td>
              <td class="tableblock halign-left valign-middle">
                <p class="tableblock">Moved Permanently - This and all future requests should be directed to the given URI.</p>
              </td>
              <td class="tableblock halign-left valign-middle">
                <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
              </td>
            </tr>
            <tr>
              <td class="tableblock halign-left valign-middle">
                <p class="tableblock" id="_status_code_302"><span class="emphasized">302</span></p>
              </td>
              <td class="tableblock halign-left valign-middle">
                <p class="tableblock">Found (Previously Moved Temporarily) - Tells the client to look at (browse to) another URL. 302 has been superseded by 303 and 307</p>
              </td>
              <td class="tableblock halign-left valign-middle">
                <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
              </td>
            </tr>
            <tr>
              <td class="tableblock halign-left valign-middle">
                <p class="tableblock" id="_status_code_303"><span class="emphasized">303</span></p>
              </td>
              <td class="tableblock halign-left valign-middle">
                <p class="tableblock">See Other - The response to the request can be found under another URI using a <a href="#_http_method_get"><span class="emphasized">GET</span></a> method.</p>
              </td>
              <td class="tableblock halign-left valign-middle">
                <p class="tableblock"><a href="#_http_method_post"><span class="emphasized">POST</span></a>, <a href="#_http_method_put"><span class="emphasized">PUT</span></a>, <a href="#_http_method_patch"><span class="emphasized">PATCH</span></a>, <a href="#_http_method_delete"><span class="emphasized">DELETE</span></a></p>
              </td>
            </tr>
            <tr>
              <td class="tableblock halign-left valign-middle">
                <p class="tableblock" id="_status_code_304"><span class="emphasized">304</span></p>
              </td>
              <td class="tableblock halign-left valign-middle">
                <p class="tableblock">Not Modified - resource has not been modified since the date or version passed via request headers If-Modified-Since or If-None-Match.</p>
              </td>
              <td class="tableblock halign-left valign-middle">
                <p class="tableblock"><a href="#_http_method_get"><span class="emphasized">GET</span></a></p>
              </td>
            </tr>
            <tr>
              <td class="tableblock halign-left valign-middle">
                <p class="tableblock" id="_status_code_307"><span class="emphasized">307</span></p>
              </td>
              <td class="tableblock halign-left valign-middle">
                <p class="tableblock">Temporary Redirect -  the request should be repeated with another URI; however, future requests should still use the original URI</p>
              </td>
              <td class="tableblock halign-left valign-middle">
                <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
              </td>
            </tr>
            </tbody>
          </table>
          <h4 id="_client_side_error_codes">Client Side Error Codes</h4>
          <table class="tableblock frame-all grid-all spread">
            <thead>
            <tr>
              <th class="tableblock halign-left valign-middle">Code</th>
              <th class="tableblock halign-left valign-middle">Meaning</th>
              <th class="tableblock halign-left valign-middle">Methods</th>
            </tr>
            </thead>
            <tbody>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_400"><span class="emphasized">400</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Bad request - generic / unknown error. Should also be delivered in case of input payload fails business logic validation.</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_401"><span class="emphasized">401</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Unauthorized - the users must log in (this often means "Unauthenticated").</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_403"><span class="emphasized">403</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Forbidden - the user is not authorized to use this resource.</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_404"><span class="emphasized">404</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Not found - the resource is not found.</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_405"><span class="emphasized">405</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Method Not Allowed - the method is not supported, see <a href="#_http_method_options"><span class="emphasized">OPTIONS</span></a>.</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_406"><span class="emphasized">406</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Not Acceptable - resource can only generate content not acceptable according to the Accept headers sent in the request.</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_408"><span class="emphasized">408</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Request timeout - the server times out waiting for the resource.</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_409"><span class="emphasized">409</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Conflict - request cannot be completed due to conflict, e.g. when two clients try to create the same resource or if there are concurrent, conflicting updates.</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><a href="#_http_method_post"><span class="emphasized">POST</span></a>, <a href="#_http_method_put"><span class="emphasized">PUT</span></a>, <a href="#_http_method_patch"><span class="emphasized">PATCH</span></a>, <a href="#_http_method_delete"><span class="emphasized">DELETE</span></a></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_410"><span class="emphasized">410</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Gone - resource does not exist any longer, e.g. when accessing a resource that has intentionally been deleted.</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_412"><span class="emphasized">412</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Precondition Failed - The server does not meet one of the preconditions that the requester put on the request header fields</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><a href="#_http_method_put"><span class="emphasized">PUT</span></a>, <a href="#_http_method_patch"><span class="emphasized">PATCH</span></a>, <a href="#_http_method_delete"><span class="emphasized">DELETE</span></a></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_415"><span class="emphasized">415</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Unsupported Media Type - e.g. clients sends request body without content type.</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><a href="#_http_method_post"><span class="emphasized">POST</span></a>, <a href="#_http_method_put"><span class="emphasized">PUT</span></a>, <a href="#_http_method_patch"><span class="emphasized">PATCH</span></a>, <a href="#_http_method_delete"><span class="emphasized">DELETE</span></a></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_423"><span class="emphasized">423</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Locked - The resource that is being accessed is locked</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><a href="#_http_method_put"><span class="emphasized">PUT</span></a>, <a href="#_http_method_patch"><span class="emphasized">PATCH</span></a>, <a href="#_http_method_delete"><span class="emphasized">DELETE</span></a></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_429"><span class="emphasized">429</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Too many requests - the client does not consider rate limiting and sent too many requests (see <a href="#_http_status_codes_4"><b><span class="red">Must:</span> Use Code 429 with Headers for Rate Limits</b></a>).</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
                </td>
              </tr>
            </tbody>
          </table>
          <h4 id="_server_side_error_codes">Server Side Error Codes</h4>
          <table class="tableblock frame-all grid-all spread">
            <thead>
            <tr>
              <th class="tableblock halign-left valign-middle">Code</th>
              <th class="tableblock halign-left valign-middle">Meaning</th>
              <th class="tableblock halign-left valign-middle">Methods</th>
            </tr>
            </thead>
            <tbody>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_500"><span class="emphasized">500</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Internal Server Error - a generic error indication for an unexpected server execution problem (here, client retry may be sensible)</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_501"><span class="emphasized">501</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Not Implemented - server cannot fulfill the request (usually implies future availability, e.g. new feature).</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_502"><span class="emphasized">502</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Bad Gateway - The server was acting as a gateway or proxy and received an invalid response from the upstream server.</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_503"><span class="emphasized">503</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Service Unavailable - service is (temporarily) not available (e.g. if a required component or downstream service is not available) — client retry may be sensible. If possible, the service should indicate how long the client should wait by setting the <span class="emphasized">Retry-After</span> header.</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock" id="_status_code_504"><span class="emphasized">504</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">Gateway Timeout - The server was acting as a gateway or proxy and did not receive a timely response from the upstream server.</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">&lt;all&gt;</span></p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_http_status_codes_3"><span class="red">Must:</span> Use Most Specific HTTP Status Codes</h3>
        <div class="paragraph">
          <p>You must use the most specific HTTP status code when returning information about your request processing status or error situations.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_http_status_codes_4"><span class="red">Must:</span> Use Code 429 with Headers for Rate Limits</h3>
        <div class="paragraph">
          <p>APIs designed to manage the request rate of clients must return the <a href="#_status_code_429"><span class="emphasized">429</span></a> (Too Many Requests) response code, if the client exceeded the request rate (see <a href="https://tools.ietf.org/html/rfc6585" target="_blank">RFC-6586</a>). In these cases, the response must also contain header information with further details for the client. There are two approaches a service can take for header information:</p>
          <ul>
            <li>Return a <span class="emphasized">Retry-After</span> header indicating how long the client should wait before making a follow-up request. The <span class="emphasized">Retry-After</span> header can contain either a HTTP date value to retry after or the number of seconds to delay. Either is acceptable but APIs should prefer to use a delay in seconds.</li>
            <li>Return a set of three <span class="emphasized">X-RateLimit</span> headers. These headers allow defining a service level as number of requests allowed by the server in a given time window and when the window is reset. Details of the headers follow below.</li>
          </ul>
          <p>The <span class="emphasized">X-RateLimit</span> headers are:</p>
          <ul>
            <li><span class="emphasized">X-RateLimit-Limit</span>: The maximum number of requests that the client is allowed to make in the current window.</li>
            <li><span class="emphasized">X-RateLimit-Remaining</span>: The number of requests remaining in the current window.</li>
            <li><span class="emphasized">X-RateLimit-Reset</span>: indicates when the current window ends, in seconds from the current time. <b>Beware:</b> this is different to Github and Twitter’s usage of a header with the same name which is using UTC epoch seconds.</li>
          </ul>
          <p>APIs can have different needs. Allowing both the described two approaches allows to meet these needs depending on the requirements.</p>
          <p>For general load handling and request throttling scenarios, when you do not need to limit access to the API by the clients, <span class="emphasized">Retry-After</span> is often sufficient. This also reduces the amount of state the server has to carry with respect to client requests.</p>
          <p>If you need to limit access to the API on a client by client basis, the <span class="emphasized">X-RateLimit</span> headers are suitable, in this case the server has to carry sufficient state to track the number of requests during a specific interval by each client. It makes sense to return these headers generally on all responses, not just on a <span class="emphasized">429</span>, so clients can manage their number of requests actively.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_http_status_codes_5"><span class="red">Must:</span> Use Problem JSON</h3>
        <div class="paragraph">
          <p><a href="https://tools.ietf.org/html/rfc7807" target="_blank">RFC 7807</a> defines a Problem JSON object and the media type <span class="emphasized">application/problem+json</span>. An API operation should return this object (together with a suitable status code) when any problem occurred on processing the request and more details can be provided aside of the status code itself, no matter if  it was caused by the client or the server (i.e. both for <a href="#_client_side_error_codes"><span class="emphasized">4xx</span></a> or <a href="#_server_side_error_codes"><span class="emphasized">5xx</span></a> error codes).</p>
          <p>The Open API schema definition of the Problem JSON object can be found on github. You can reference it by using:</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              <span class="purple">responses</span>:<br/>
              <span class="purple" style="padding-left: 1em;">503</span><br/>
              <span class="purple" style="padding-left: 2em;">description</span>: <span class="red">Service Unavailable</span><br/>
              <span class="purple" style="padding-left: 2em;">content</span>:<br/>
              <span class="purple" style="padding-left: 3em;">"application/problem+json"</span>:<br/>
              <span class="purple" style="padding-left: 4em;">schema</span>:<br/>
              <span class="purple" style="padding-left: 5em;">$ref</span>:<span class="red">'https://<i>link einfügen</i>/problem/schema.yaml#/Problem'</span>
            </code>
          </p>
          <p>Custom problem types can be defined as extension of the Problem JSON object if your API need to return specific additional error detail information.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_http_status_codes_6"><span class="red">Must:</span> Do not expose Stack Traces</h3>
        <div class="paragraph">
          <p>Stack traces contain implementation details. These:</p>
          <ul>
            <li>are not part of an API (an API should always be independent of the implementation)</li>
            <li>can leak sensitive information, which should not be disclosed to partners and third parties and can allow insights into vulnerabilities to hackers.</li>
          </ul>
          <p>Therefore stack traces should never be part of an API response.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_performance">13. Performance</h2>
    <div class="sectionbody">
      <div class="sect2">
        <h3 id="_performance_1"><span class="yellow">Should:</span> Reduce Bandwidth Needs and Improve Responsiveness</h3>
        <div class="paragraph">
          <p>APIs should support techniques for reducing bandwidth based on client needs. This is especially important for APIs likely to cause high traffic (i.e. by frequent calls) or processing large payloads. This also is necessary for scenarios where bandwidth can not be guaranteed, e.g. the public Internet and telecommunication networks.</p>
          <p>Common techniques include:</p>
          <ul>
            <li>compression of request and response bodies (see <a href="#_performance_2"><b><span class="yellow">Should:</span> Use gzip Compression)</b></a></li>
            <li>query field filters to retrieve a subset of resource attributes (see <a href="#_performance_3"><b><span class="yellow">Should:</span> Support Partial Responses via Filtering</b></a>)</li>
            <li><span class="emphasized">ETag</span> and <span class="emphasized">If-Match</span>/<span class="emphasized">If-None-Match</span> headers to avoid re-fetching of unchanged resources (see <a href="#_common_headers_5"><b><span class="green">May:</span> Consider to Support <span class="emphasized">ETag</span> Together With <span class="emphasized">If-Match</span>/<span class="emphasized">If-None-Match</span> Header</b></a>)</li>
            <li><a href="#_pagination">Pagination</a> for incremental access of larger collections of data items</li>
            <li>caching of master data items, i.e. resources that change rarely or not at all after creation (see <a href="#_performance_4"><b><span class="red">Must:</span> Document Cachable <span class="emphasized">GET</span>, <span class="emphasized">HEAD</span>, and <span class="emphasized">POST</span> Endpoints</b></a>).</li>
          </ul>
          <p>Each of these items is described in greater detail below.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_performance_2"><span class="yellow">Should:</span> Use gzip Compression</h3>
        <div class="paragraph">
          <p>If content length exceeds a specified length (currently 1024B) the payload of an API’s response should be compressed with gzip - unless there’s a good reason not to, e.g. so many requests are served that compression time becomes a bottleneck. This reduces the payload to be transported and can cause faster response times.</p>
          <p>When gzip compression is the default choice for server payload, the server should also support payload without compression. This should be made controllable to the client via <a href="https://tools.ietf.org/html/rfc7231#section-5.3.4" target="_blank"><span class="emphasized">Accept-Encoding</span></a> request header — see also <a href="https://tools.ietf.org/html/rfc7231#section-5.3.4" target="_blank">RFC 7231 Section 5.3.4.</a> The server should indicate gzip compression via the <a href="https://tools.ietf.org/html/rfc7231#section-3.1.2.2" target="_blank"><span class="emphasized">Content-Encoding</span></a> header.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_performance_3"><span class="yellow">Should:</span> Support Partial Responses via Filtering</h3>
        <div class="paragraph">
          <p>Depending on your use case and payload size, network bandwidth requirements can significantly be reduced by supporting the filtering of the returned entity fields. This means, a client can explicitly determine the subset of fields he wants to receive via the <span class="emphasized">fields</span> query parameter.</p>
          <h4>Unfiltered</h4>
          <p class="preformatted-custom">
            <code style="padding:0">
              GET http://api.example.org/benutzer/123 HTTP/1.1<br/><br/>
              HTTP/1.1 200 OK<br/>
              Content-Type: application/json<br/><br/>
              {<br/>
              <span style="padding-left: 1em;">"id": "123",</span><br/>
              <span style="padding-left: 1em;">"name": "Max Mustermann",</span><br/>
              <span style="padding-left: 1em;">"adresse": "Musterstraße 1, 12345 Musterstadt",</span><br/>
              <span style="padding-left: 1em;">"geburtstag": "1984-09-13",</span><br/>
              <span style="padding-left: 1em;">"handelspartner": [ {</span><br/>
              <span style="padding-left: 2em;">"id": "124",</span><br/>
              <span style="padding-left: 2em;">"name": "Muster Maxmann",</span><br/>
              <span style="padding-left: 2em;">"address": "Klosterstr. 71, 10179 Berlin",</span><br/>
              <span style="padding-left: 2em;">"geburtstag": "1988-04-07"</span><br/>
              <span style="padding-left: 1em;">} ]</span><br/>
              }
            </code>
          </p>
          <h4>Filtered</h4>
          <p class="preformatted-custom">
            <code style="padding:0">
              GET http://api.example.org/benutzer/123?fields=(name,handelspartner(name)) HTTP/1.1<br/><br/>
              HTTP/1.1 200 OK<br/>
              Content-Type: application/json<br/><br/>
              {<br/>
              <span style="padding-left: 1em;">"name": "Max Mustermann",</span><br/>
              <span style="padding-left: 1em;">"handelspartner": [ {</span><br/>
              <span style="padding-left: 2em;">"name": "Muster Maxmann",</span><br/>
              <span style="padding-left: 1em;">} ]</span><br/>
              }
            </code>
          </p>
          <p>The query <span class="emphasized">fields</span> value defines which fields should be returned with the response payload object. For instance, <span class="emphasized">(name)</span> returns <span class="emphasized">benutzer</span> root object with only the <span class="emphasized">name</span> field, and <span class="emphasized">(name,handelspartner(name))</span> returns the <span class="emphasized">name</span> and the nested <span class="emphasized">handelspartner</span> object with only its <span class="emphasized">name</span> field.</p>
          <p>OpenAPI does not support formal specification of different return object schemes depending on a parameter. When you define the fields parameter, we recommend to provide the following description:</p>
          <p>The syntax of the query <span class="emphasized">fields</span> value is defined by the following <a href="https://en.wikipedia.org/wiki/Backus–Naur_form" target="_blank">BNF</a> grammar.</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              &lt;fields&gt;            ::= [ &lt;negation&gt; ] &lt;fields_struct&gt;<br/>
              &lt;fields_struct&gt;     ::= "(" &lt;field_items&gt; ")"<br/>
              &lt;field_items&gt;       ::= &lt;field&gt; [ "," &lt;field_items&gt; ]<br/>
              &lt;field&gt;             ::= &lt;field_name&gt; | &lt;fields_substruct&gt;<br/>
              &lt;fields_substruct&gt;  ::= &lt;field_name&gt; &lt;fields_struct&gt;<br/>
              &lt;field_name&gt;        ::= &lt;dash_letter_digit&gt; [ &lt;field_name&gt; ]<br/>
              &lt;dash_letter_digit&gt; ::= &lt;dash&gt; | &lt;letter&gt; | &lt;digit&gt;<br/>
              &lt;dash&gt;              ::= "-" | "_"<br/>
              &lt;letter&gt;            ::= "A" | ... | "Z" | "a" | ... | "z"<br/>
              &lt;digit&gt;             ::= "0" | ... | "9"<br/>
              &lt;negation&gt;          ::= "!"
            </code>
          </p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_performance_4"><span class="red">Must:</span> Document Cacheable <span class="emphasized">GET</span>, <span class="emphasized">HEAD</span>, and <span class="emphasized">POST</span> Endpoints</h3>
        <div class="paragraph">
          <p>To use caching in an API endpoint, you must take many aspects into account, e.g. </p>
          <ul>
            <li>is the response information cacheable (changeability, memory requirements,...)</li>
            <li>guidelines to protect endpoints using SSL and <a href="#_security_1">OAuth2 authorization</a></li>
            <li>resource update and invalidation rules</li>
            <li>existence of multiple consumer instances</li>
            <li>...</li>
          </ul>
          <p>All these considerations can make caching of resource information highly complex. As worst case caching can be more inefficient than retrieving and assembling the information on each call.</p>
          <p>Following this, client side caching and transparent web caching should be avoided in most cases, except when the service requires it to protect itself, e.g. in case of a heavily used and therefore rate limited master data service, especially if the requested information consists of data items that rarely or not at all change after creation.</p>
          <p>As default, <a href="https://tools.ietf.org/html/rfc7234#section-5.2" target="_blank"><span class="emphasized">Cache-Control</span></a> header should always be set to <a href="https://tools.ietf.org/html/rfc7234#section-5.2.2.2" target="_blank"><span class="emphasized">Cache-Control: no-store</span></a> by API providers and consumers. If no <a href="https://tools.ietf.org/html/rfc7234#section-5.2" target="_blank"><span class="emphasized">Cache-Control</span></a> header is provided, the same setting should be assumed.</p>
          <p><b>Note:</b> This default setting need not be documented. It is good practice however to attach this header value by default, or ensure this manually. This can be done using the best practice of Spring Security as shown below. If your setup is deviating from this default, you must document the implemented behavior.</p>
          <p class="preformatted-custom"><code>Cache-Control: no-cache, no-store, must-revalidate, max-age=0</code></p>
          <p>If your service has to support caching, you should observe the following rules:</p>
          <ul>
            <li>Document all cacheable <a href="#_http_method_get"><span class="emphasized">GET</span></a>, <a href="#_http_method_head"><span class="emphasized">HEAD</span></a>, and <a href="#_http_method_post"><span class="emphasized">POST</span></a> endpoints by declaring the support of <a href="https://tools.ietf.org/html/rfc7234#section-5.2" target="_blank"><span class="emphasized">Cache-Control</span></a>, <a href="https://tools.ietf.org/html/rfc7231#section-7.1.4" target="_blank"><span class="emphasized">Vary</span></a>, and <a href="https://tools.ietf.org/html/rfc7232#section-2.3" target="_blank"><span class="emphasized">ETag</span></a> headers in response. <b>Note:</b> you must not define the <a href="https://tools.ietf.org/html/rfc7234#section-5.3" target="_blank"><span class="emphasized">Expires</span></a> header to prevent redundant and ambiguous definition of cache lifetime. A sensible default documentation of these headers is given below.</li>
            <li>Be careful when specifying the ability to support caching by defining the right caching boundaries, i.e. time-to-live and cache constraints, by providing sensible values for <a href="https://tools.ietf.org/html/rfc7234#section-5.2" target="_blank"><span class="emphasized">Cache-Control</span></a> and <a href="https://tools.ietf.org/html/rfc7231#section-7.1.4" target="_blank"><span class="emphasized">Vary</span></a> in your service. Best practices are explained below.</li>
            <li>Provide efficient methods to prefill and update caches, e.g. as follows:
              <ul>
                <li>In general, you should support <a href="#_common_headers_5"></b><span class="emphasized">ETag</span> Together With <span class="emphasized">If-Match</span>/<span class="emphasized">If-None-Match</span> Header</a> on all cacheable endpoints.</li>
                <li>For larger data items support <a href="#_http_method_head"><span class="emphasized">HEAD</span></a> requests or more efficient <a href="#_http_method_get"><span class="emphasized">GET</span></a> requests with <a href="https://tools.ietf.org/html/rfc7232#section-3.2" target="_blank"><span class="emphasized">If-None-Match</span></a> header to check for updates.</li>
                <li>For small data sets provide full collection <a href="#_http_method_get"><span class="emphasized">GET</span></a> requests supporting <a href="https://tools.ietf.org/html/rfc7232#section-2.3" target="_blank"><span class="emphasized">ETag</span></a>, as well as <a href="#_http_method_head"><span class="emphasized">HEAD</span></a> requests or <a href="#_http_method_get"><span class="emphasized">GET</span></a> requests with <a href="https://tools.ietf.org/html/rfc7232#section-3.2" target="_blank"><span class="emphasized">If-None-Match</span></a> to check for updates.</li>
                <li>For medium sized data sets provide full collection <a href="#_http_method_get"><span class="emphasized">GET</span></a> requests supporting <a href="https://tools.ietf.org/html/rfc7232#section-2.3" target="_blank"><span class="emphasized">ETag</span></a> together with <a href="#_pagination">Pagination</a> and <span class="emphasized">&lt;entity-tag&gt;</span> filtering <a href="#_http_method_get"><span class="emphasized">GET</span></a> requests for limiting the response to changes since the provided <span class="emphasized">&lt;entity-tag&gt;</span>. <b>Note:</b> this is not supported by generic client and proxy caches on HTTP layer.</li>
              </ul>
            </li>
          </ul>
          <p><b>Hint:</b> For proper cache support, you must return <a href="#_status_code_304"><span class="emphasized">304</span></a> without content on a failed <a href="#_http_method_head"><span class="emphasized">HEAD</span></a> or <a href="#_http_method_get"><span class="emphasized">GET</span></a> request with <span class="emphasized">If-None-Match: &lt;entity-tag&gt;</span> instead of <a href="#_status_code_412"><span class="emphasized">412.</span></a></p>
          <p class="preformatted-custom">
            <code style="padding:0">
              <span class="purple">components</span>:<br/>
              <span class="purple" style="padding-left: 1em;">headers</span>:<br/>
              <span style="padding-left: 1em;">- <span class="red">Cache-Control:</span></span><br/>
              <span class="red" style="padding-left: 2em;">description: |</span><br/>
              <span class="red" style="padding-left: 3em;">The RFC 7234 Cache-Control header field is providing directives to control how proxies and clients are allowed to cache response results for performance. Clients and proxies are free to not support caching of results, however if they do, they must obey all directives mentioned in [RFC-7234 Section 5.2.2] (https://tools.ietf.org/html/rfc7234) to the word.<br/><br/>
                In case of caching, the directive provides the scope of the cache entry, i.e. only for the original user (private) or shared between all users (public), the lifetime of the cache entry in seconds (max-age), and the strategy how to handle a stale cache entry (must-revalidate). Please note, that the lifetime and validation directives for shared caches are different (s-maxage, proxy-revalidate).<br/>
              </span><br/>
              <span class="red" style="padding-left: 2em;">type: string</span><br/>
              <span class="red" style="padding-left: 2em;">required: false</span><br/>
              <span class="red" style="padding-left: 2em;">example: "private, must-revalidate, max-age=300"</span><br/><br/>
              <span style="padding-left: 1em;">- <span class="red">Vary:</span></span><br/>
              <span class="red" style="padding-left: 2em;">description: |</span><br/>
              <span class="red" style="padding-left: 3em;">The RFC 7231 Vary header field in a response defines which parts of a request message, aside the target URL and HTTP method, might have influenced the response. A client or proxy cache must respect this information, to ensure that it delivers the correct cache entry (see [RFC-7231 Section 7.1.4] (https://tools.ietf.org/html/rfc7231#section-7.1.4)).</span><br/>
              <span class="red" style="padding-left: 2em;">type: string</span><br/>
              <span class="red" style="padding-left: 2em;">required: false</span><br/>
              <span class="red" style="padding-left: 2em;">example: "accept-encoding, accept-language"</span><br/>
            </code>
          </p>
          <p><b>Hint:</b> Europace’s APIs are working on a highly language specific domain. A lot of the code is therefore written and documented in German. The example above is written in English for consistency reasons with the guideline document. When using the above described headers, feel free to use German in the OpenAPI definition of your API.</p>
          <p><b>Hint:</b> For <a href="https://tools.ietf.org/html/rfc7232#section-2.3" target="_blank"><span class="emphasized">ETag</span></a> source see <a href="#_common_headers_5"><b><span class="green">May:</span> Consider to Support <span class="emphasized">ETag</span> Together With <span class="emphasized">If-Match</span>/<span class="emphasized">If-None-Match</span> Header</b></a>.</p>
          <p>The default setting for <a href="https://tools.ietf.org/html/rfc7234#section-5.2" target="_blank"><span class="emphasized">Cache-Control</span></a> should contain</p>
          <ul>
            <li>the <span class="emphasized">private</span> directive for endpoints with standard <a href="#_security_1">OAuth2 authorization</a></li>
            <li>the <span class="emphasized">must-revalidate</span> directive to ensure that the client does not use stale cache entries</li>
            <li>the <span class="emphasized">max-age</span> directive should be set to a value between a few seconds (<span class="emphasized">max-age=60</span>) and a few hours (<span class="emphasized">max-age=86400</span>) depending on the change rate of your master data and your requirements to keep clients consistent.</li>
          </ul>
          <p class="preformatted-custom">
            <code style="padding:0">Cache-Control: private, must-revalidate, max-age=300</code>
          </p>
          <p>It is harder to determine the default setting for <a href="https://tools.ietf.org/html/rfc7231#section-7.1.4" target="_blank"><span class="emphasized">Vary</span></a> header correctly. It highly depends on the API endpoint, e.g. whether it supports compression, accepts different media types, or requires other request specific headers. To implement caching correctly, the value has to be chosen carefully. A good first default may be:</p>
          <p class="preformatted-custom">
            <code style="padding:0">Vary: accept, accept-encoding</code>
          </p>
          <p>Anyhow, this is only relevant, if you encourage clients to install generic HTTP layer client and proxy caches. Generic client and proxy caching on HTTP level is hard to configure. We strongly recommend to attach the (possibly distributed) cache directly to the service (or gateway) layer of your application. This relieves from interpreting the <a href="https://tools.ietf.org/html/rfc7231#section-7.1.4" target="_blank"><span class="emphasized">Vary</span></a> header and greatly simplifies interpreting the <a href="https://tools.ietf.org/html/rfc7234#section-5.2" target="_blank"><span class="emphasized">Cache-Control</span></a> and <a href="https://tools.ietf.org/html/rfc7232#section-2.3" target="_blank"><span class="emphasized">ETag</span></a> headers. It is also highly efficient with respect to caching performance and overhead, and allows to support more advanced cache update and prefill patterns.</p>
          <p><b>Final note:</b> please read <a href="https://tools.ietf.org/html/rfc7234" target="_blank">RFC 7234</a> carefully before adding any client or proxy cache.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_pagination">14. Pagination</h2>
    <div class="sectionbody">
      <div class="sect2">
        <h3 id="_pagination_1"><span class="red">Must:</span> Support Pagination</h3>
        <div class="paragraph">
          <p>If your API endpoint is to return lists of resource items, the endpoint must support pagination to protect the service against overload and for support of client side iteration and batch processing experience. This is true for all lists that can (potentially) contain more than a few hundred entries.</p>
          <p>There are two well known page iteration techniques:</p>
          <ul>
            <li>Offset/Limit-based pagination: numeric offset identifies the first page entry</li>
            <li>Cursor/Limit-based — aka key-based — pagination: a unique key element identifies the first page entry</li>
          </ul>
          <p>Please also consider UX related issues when doing the technical conception of pagination. Current standard in our public APIs (where pagination is used) is providing <span class="emphasized">next</span>/<span class="emphasized">prev page</span> links (See <a href="#_pagination_3"><b><span class="green">May:</span> Use Pagination Links Where Applicable</b></a>) together with <span class="emphasized">page</span>/<span class="emphasized">offset</span> query parameter combination to allow, jumping to a specific page.</p>
          <p>Note: To provide a consistent look and feel of pagination patterns, you must stick to the common query parameter names defined in <a href="#_naming_7"><b><span class="red">Must:</span> Stick to Conventional Query Parameters</b></a>.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_pagination_2"><span class="yellow">Should:</span> Use Offset-Based Pagination, Avoid Cursor-Based Pagination</h3>
        <div class="paragraph">
          <p>Europace public APIs currently use offset-based pagination with a combination of <span class="emphasized">page</span>/<span class="emphasized">offset</span> query parameters. Offset-based pagination is more commonly known and therefore has better framework support than cursor-based pagination and is widely accepted by consumers. The use case to jump to a specific page is more easy to understand in a result list context than jumping to a specific entry. Therefore we recommend using offset-based pagination in your API. In addition the response data should contain <span class="emphasized">next</span>/<span class="emphasized">prev</span> page.</p>
          <p>However, you should consider the following disadvantages of offset-based pagination:</p>
          <ul>
            <li>a change of the data set between API calls can create duplicates or missing entries in the result</li>
            <li>if requesting larger volumes of data, performance of offset-based pagination can be lower than the equivalent cursor-based variant.</li>
          </ul>
          <p>But, on the other hand, cursor-based pagination has equally big problems:</p>
          <ul>
            <li>paging breaks, when cursor entry was deleted between calls</li>
            <li>if you need total count of result and / or backwards iteration support, cursor-based pagination may not work</li>
          </ul>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_pagination_3"><span class="green">May:</span> Use Pagination Links Where Applicable</h3>
        <div class="paragraph">
          <p>Those collections should then have an attribute named depending on the resource type holding the items of the current page. It’s possible to include additional metadata about the collection or the current page when necessary.</p>
          <p>Avoid providing a total count in your API, unless there is a clear need to do so or a specific requirement to provide this information. Supporting full counts can often imply memory or performance problems, especially when requesting already large or growing data sets or when requests use complex queries or filters resulting in full database scans. This might be a consideration in relation to the API in question, but the question has to be considered for the whole lifecycle of the API (data sets can grow, in count as well as complexity). Also we want our Europace APIs to have the same look and feel, so providing total count in a response of one API, when not strictly necessary, should be avoided, since it might not be possible for the next API.</p>
          <p>If the collection consists of links to other resources, the collection name should use <a href="http://www.iana.org/assignments/link-relations/link-relations.xml" target="_blank">IANA registered link relations</a> as names whenever appropriate, but use plural form.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_hypermedia">15. Hypermedia</h2>
    <div class="sectionbody">
      <div class="sect2">
        <h3 id="_hypermedia_1"><span class="red">Must:</span> Use REST Maturity Level 2</h3>
        <div class="paragraph">
          <p>We’re aiming to implement <a href="http://martinfowler.com/articles/richardsonMaturityModel.html#level2" target="_blank">REST Maturity Level 2</a> as it enables us to build resource-oriented APIs that make full use of HTTP verbs and status codes. This is expressed in many rules in these guidelines, e.g.:</p>
          <ul>
            <li><a href="#_resources_1"><b><span class="red">Must:</span> Avoid Actions — Think About Resources</b></a></li>
            <li><a href="#_resources_4"><b><span class="red">Must:</span> Keep URLs Verb-Free</b></a></li>
            <li><a href="#_http_requests_1"><b><span class="red">Must:</span> Use HTTP Methods Correctly</b></a></li>
            <li><a href="#_http_status_codes_2"><b><span class="red">Must:</span> Use Standard HTTP Status Codes</b></a></li>
          </ul>
          <p>Although this is not HATEOAS, it does not prevent you from designing proper link relationships in your APIs as stated in rules below.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_hypermedia_2"><span class="red">Must:</span> Use fully qualified URI</h3>
        <div class="paragraph">
          <p>Links to other resources exposed in an API response must always use fully qualified URI.</p>
          <p><b>Motivation:</b> Exposing any form of relative URI (both with absolute or relative path) in API responses causes avoidable client side complexity. The primary advantage of relative URIs is reduction of the payload size, this can be achieved in a better way by <a href="#_performance_2">gzip compression</a>.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_hypermedia_3"><span class="red">Must:</span> Use Common Hypertext Controls</h3>
        <div class="paragraph">
          <p>When embedding links to other resources into API responses you must use the common hypertext control object. It contains at least one attribute:</p>
          <ul>
            <li><span class="emphasized">href</span>: The URI of the resource the hypertext control is linking to. All our API are using HTTP(S) as URI scheme.</li>
          </ul>
          <p>When your API is using any hypertext controls, the attribute name <span class="emphasized">href</span> is reserved for usage within the hypertext controls. We also strongly recommend avoiding the attribute name <span class="emphasized">href</span> for anything else, even if your API is not using hypertext controls.</p>
          <p>To represent external links for self-reference or pagination in an Europace API you can use one of the definitions of <span class="emphasized">Links</span> or <span class="emphasized">PaginationLinks</span> (depending on the type of link) provided in our common definitions specification.</p>
          <p>Specification example Links (baufismart-vorgaenge-api):</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              <span class="purple">definitions</span>:<br/>
              <span class="purple" style="padding-left: 1em;">Angebot</span>:<br/>
              <span style="padding-left: 2em;">...</span><br/>
              <span class="purple" style="padding-left: 2em;">_links</span>:<br/>
              <span class="purple" style="padding-left: 3em;">$ref</span>: <span class="red">"#/definitions/Links"</span><br/>
              <span style="padding-left: 2em;">...</span><br/><br/>
              <span class="purple" style="padding-left: 1em;">Link</span>:<br/>
              <span class="purple" style="padding-left: 2em;">type</span>: <span class="red">"object"</span><br/>
              <span class="purple" style="padding-left: 2em;">properties</span>:<br/>
              <span class="purple" style="padding-left: 3em;">href</span>:<br/>
              <span class="purple" style="padding-left: 4em;">type</span>: <span class="red">"string"</span><br/>
              <span class="purple" style="padding-left: 3em;">type</span>:<br/>
              <span class="purple" style="padding-left: 4em;">type</span>: <span class="red">"string"</span><br/>
              <span class="purple" style="padding-left: 2em;">title</span>: <span class="red">"Link"</span><br/>
              <span class="purple" style="padding-left: 1em;">Links</span>:<br/>
              <span class="purple" style="padding-left: 2em;">type</span>: <span class="red">"object"</span><br/>
              <span class="purple" style="padding-left: 2em;">properties</span>:<br/>
              <span class="purple" style="padding-left: 3em;">self</span>:<br/>
              <span class="purple" style="padding-left: 4em;">$ref</span>: <span class="red">"#/definitions/Link"</span><br/>
              <span class="purple" style="padding-left: 2em;">title</span>: <span class="red">"Links"</span><br/>
            </code>
          </p>
          <p>Specification example PaginationLinks (baufismart-vorgaenge-api):</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              <span class="purple">definitions</span>:<br/>
              <span class="purple" style="padding-left: 1em;">Antraege</span>:<br/>
              <span style="padding-left: 2em;">...</span><br/>
              <span class="purple" style="padding-left: 2em;">_links</span>:<br/>
              <span class="purple" style="padding-left: 3em;">$ref</span>: <span class="red">"#/definitions/PaginationLinks"</span><br/>
              <span style="padding-left: 2em;">...</span><br/><br/>
              <span class="purple" style="padding-left: 1em;">Link</span>:<br/>
              <span class="purple" style="padding-left: 2em;">type</span>: <span class="red">"object"</span><br/>
              <span class="purple" style="padding-left: 2em;">properties</span>:<br/>
              <span class="purple" style="padding-left: 3em;">href</span>:<br/>
              <span class="purple" style="padding-left: 4em;">type</span>: <span class="red">"string"</span><br/>
              <span class="purple" style="padding-left: 3em;">type</span>:<br/>
              <span class="purple" style="padding-left: 4em;">type</span>: <span class="red">"string"</span><br/>
              <span class="purple" style="padding-left: 2em;">title</span>: <span class="red">"Link"</span><br/>
              <span style="padding-left: 1em;">...</span><br/>
              <span class="purple" style="padding-left: 1em;">PaginationLinks</span>:<br/>
              <span class="purple" style="padding-left: 2em;">type</span>: <span class="red">"object"</span><br/>
              <span class="purple" style="padding-left: 2em;">properties</span>:<br/>
              <span class="purple" style="padding-left: 3em;">next</span>:<br/>
              <span class="purple" style="padding-left: 4em;">$ref</span>: <span class="red">"#/definitions/Link"</span><br/>
              <span class="purple" style="padding-left: 3em;">prev</span>:<br/>
              <span class="purple" style="padding-left: 4em;">$ref</span>: <span class="red">"#/definitions/Link"</span><br/>
              <span class="purple" style="padding-left: 3em;">self</span>:<br/>
              <span class="purple" style="padding-left: 4em;">$ref</span>: <span class="red">"#/definitions/Link"</span><br/>
              <span class="purple" style="padding-left: 2em;">title</span>: <span class="red">"PaginationLinks"</span><br/>
            </code>
          </p>
          <p>There might be other use cases in your API where you need to provide a link to an external response in the API’s response. Also in definitions of links other than self-reference and pagination you must use href attribute for the link URI. Specific link objects may extend the basic link type with additional attributes, to give additional information related to the linked resource or the relationship between the source resource and the linked one. See below example for <span class="emphasized">Dokument</span> specification in baufismart-vorgaenge-api:</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              <span class="purple">Dokument</span>:<br/>
              <span class="purple" style="padding-left: 1em;">type</span>: <span class="red">"object"</span><br/>
              <span class="purple" style="padding-left: 1em;">properties</span>:<br/>
              <span class="purple" style="padding-left: 2em;">art</span>:<br/>
              <span class="purple" style="padding-left: 3em;">type</span>: <span class="red">"string"</span><br/>
              <span class="purple" style="padding-left: 2em;">href</span>:<br/>
              <span class="purple" style="padding-left: 3em;">type</span>: <span class="red">"string"</span><br/>
              <span class="purple" style="padding-left: 2em;">name</span>:<br/>
              <span class="purple" style="padding-left: 3em;">type</span>: <span class="red">"string"</span><br/>
              <span class="purple" style="padding-left: 2em;">titel</span>:<br/>
              <span class="purple" style="padding-left: 3em;">type</span>: <span class="red">"string"</span><br/>
              <span class="purple" style="padding-left: 2em;">type</span>:<br/>
              <span class="purple" style="padding-left: 3em;">type</span>: <span class="red">"string"</span><br/>
              <span class="purple" style="padding-left: 1em;">title</span>: <span class="red">"Dokument"</span><br/>
            </code>
          </p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_hypermedia_4"><span class="red">Must:</span> Use Link Headers with JSON entities</h3>
        <div class="paragraph">
          <p>Do not use the <span class="emphasized">Link</span> Header defined by <a href="https://tools.ietf.org/html/rfc8288#section-3" target="_blank">RFC 8288</a> in conjunction with JSON media types. Links should be embedded directly in JSON payloads, instead in the uncommon link header syntax.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_data_formats">16. Data Formats</h2>
    <div class="sectionbody">
      <div class="sect2">
        <h3 id="_data_formats_1"><span class="red">Must:</span> Use JSON to Encode Structured Data</h3>
        <div class="paragraph">
          <p>Use JSON body payload for transferring structured data. The JSON payload must follow <a href="https://tools.ietf.org/html/rfc7159" target="_blank">RFC 7159</a> by having (if possible) a serialized object as the top-level structure. This allows for future extensions. This rule should also be followed for collection resources where one would expect an array. Instead of returning an array, return a serialized object containing the array. This allows for adding additional (meta) information on the same level, if necessary. See also <a href="#_compatibility_5"><b><span class="yellow">Should:</span> Always Return JSON Objects As Top-Level Data Structures To Support Extensibility</b></a></p>
          <p>Additionally, the JSON payload must comply to <a href="https://tools.ietf.org/html/rfc7493" target="_blank">RFC 7493</a>, particularly</p>
          <ul>
            <li><a href="https://tools.ietf.org/html/rfc7493#section-2.1" target="_blank">Section 2.1</a> on encoding of characters, and</li>
            <li><a href="https://tools.ietf.org/html/rfc7493#section-2.3" target="_blank">Section 2.3</a> on object constraints.</li>
          </ul>
          <p>As a consequence, a JSON payload must</p>
          <ul>
            <li>use UTF-8 encoding</li>
            <li>consist of valid Unicode strings, i.e. must not contain non-characters or surrogates, and</li>
            <li>contain only unique member names (no duplicate names).</li>
          </ul>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_data_formats_2"><span class="green">May:</span> Use non JSON Media Types for Binary Data or Alternative Content Representations</h3>
        <div class="paragraph">
          <p>There may be cases where JSON structured payload is inconvenient or impossible to use for response data. Other media types may be used in following cases:</p>
          <ul>
            <li>Transferring binary data or data whose structure is not relevant. This is the case if payload structure is not interpreted and consumed by clients as is. Example of such use case is downloading images in formats JPG, PNG, GIF or downloading customer uploaded documents, e.g. PDF format.</li>
            <li>Sometimes it could be useful to allow alternative data representations additionally to JSON version to allow for human readability or tool support (e.g. in formats PDF, DOC, XML). This can be achieved through content negotiation.</li>
          </ul>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_data_formats_3"><span class="yellow">Should:</span> Prefer standard Media type name <span class="emphasized">application/json</span></h3>
        <div class="paragraph">
          <p>Use standard media type name <span class="emphasized">application/json</span> for your response data (<span class="emphasized">application/problem+json</span> for error responses, see <a href="#_http_status_codes_5"><b><span class="red">Must:</span> Use Problem JSON</b></a>). We discourage the usage of custom media types.</p>
          <p>Custom media types beginning with <span class="emphasized">x</span> bring no advantage compared to the standard media type for JSON, and make automated processing more difficult. They are also discouraged by <a href="https://tools.ietf.org/html/rfc6838#section-3.4" target="_blank">RFC 6838</a>.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_data_formats_4"><span class="red">Must:</span> Use Standard Date and Time Formats</h3>
        <div class="paragraph">
          <h4>JSON Payload</h4>
          <p>Read more about date and time format in <a href="#_json_guidelines_8"><b><span class="red">Must:</span> Date property values must conform to ISO 8601</b></a>.</p>
          <h4>HTTP headers</h4>
          <p>Http headers including the proprietary headers use the <a href="https://tools.ietf.org/html/rfc7231#section-7.1.1.1" target="_blank">HTTP date format defined in RFC 7231</a>.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_data_formats_5"><span class="yellow">Should:</span> Use Standards for Country, Language and Currency Codes</h3>
        <div class="paragraph">
          <p>Use the following standard formats for country, language and currency codes:</p>
          <ul>
            <li><a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2" target="_blank">ISO 3166-1-alpha2 country codes</a></li>
            <li><a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes" target="_blank">ISO 639-1 language code</a>
              <ul>
                <li><a href="https://tools.ietf.org/html/bcp47" target="_blank">BCP-47</a> (based on <a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes" target="_blank">ISO 639-1</a>) for language variants</li>
              </ul>
            </li>
            <li><a href="https://en.wikipedia.org/wiki/ISO_4217" target="_blank">ISO 4217 currency codes</a></li>
          </ul>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_data_formats_6"><span class="red">Must:</span> Define Format for Type Number and Integer</h3>
        <div class="paragraph">
          <p>For each property of type <span class="emphasized">number</span> or <span class="emphasized">integer</span> defined in an API specification, the precision must be defined by the format as follows. This prevents clients from guessing the precision incorrectly, the value can not be changed unintentionally:</p>
          <table class="tableblock frame-all grid-all spread">
            <thead>
            <tr>
              <th class="tableblock halign-left valign-middle">type</th>
              <th class="tableblock halign-left valign-middle">format</th>
              <th class="tableblock halign-left valign-middle">specified value range</th>
            </tr>
            </thead>
            <tbody>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">integer</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">int32</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">integer between -231 and 231-1</p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">integer</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">int64</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">integer between -263 and 263-1</p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">integer</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">bigint</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">arbitrarily large signed integer number</p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">number</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">float</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><a href="https://en.wikipedia.org/wiki/IEEE_754" target="_blank">IEEE 754-2008/ISO 60559:2011</a> binary64 decimal number</p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">number</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">double</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><a href="https://en.wikipedia.org/wiki/IEEE_754" target="_blank">IEEE 754-2008/ISO 60559:2011</a> binary128 decimal number</p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">number</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">decimal</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">arbitrarily precise signed decimal number</p>
                </td>
              </tr>
            </tbody>
          </table>
          <p>The precision must be translated by clients and servers into the most specific language types. </p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_common_data_types">17. Common Data Types</h2>
    <div class="sectionbody">
      <div class="paragraph">
        <p>Definitions of data objects that are good candidates for wider usage:</p>
      </div>
      <div class="sect2">
        <h3 id="_common_data_types_1"><span class="yellow">Should:</span> Use a Common Geld Object</h3>
        <div class="paragraph">
          <p>Use the following common Geld structure:</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              <span class="purple">Geld</span>:<br/>
              <span class="purple" style="padding-left: 1em;">type</span>: <span class="red">object</span><br/>
              <span class="purple" style="padding-left: 1em;">properties</span>:<br/>
              <span class="purple" style="padding-left: 2em;">betrag</span>:<br/>
              <span class="purple" style="padding-left: 3em;">type</span>: <span class="red">number</span><br/>
              <span class="purple" style="padding-left: 3em;">description</span>: <span class="red">Geldbetrag als Dezimalziffer von Hauptwährungseinheiten</span><br/>
              <span class="purple" style="padding-left: 3em;">multipleOf</span>: <span class="red">0.01</span><br/>
              <span class="purple" style="padding-left: 3em;">example</span>: <span class="red">99,95</span><br/>
              <span class="purple" style="padding-left: 2em;">waehrung</span>:<br/>
              <span class="purple" style="padding-left: 3em;">type</span>: <span class="red">string</span><br/>
              <span class="purple" style="padding-left: 3em;">description</span>: <span class="red">Währungscode 3-stellig wie definiert von ISO-4217</span><br/>
              <span class="purple" style="padding-left: 3em;">format</span>: <span class="red">iso-4217</span><br/>
              <span class="purple" style="padding-left: 3em;">example</span>: <span class="red">EUR</span><br/>
              <span class="purple" style="padding-left: 1em;">required</span>:<br/>
              <span style="padding-left: 2em;">- <span class="red">betrag</span></span><br/>
              <span style="padding-left: 2em;">- <span class="red">waehrung</span></span>
            </code>
          </p>
          <p>Since Europace designs its software and also its APIs in a very German domain, naming of data types and decimal format is also done in German language and locale format.</p>
          <p>The decimal values for "betrag" describe unit and subunit of the currency in a single value, where the digits before the decimal comma are for the major unit and the digits after the decimal comma are for the minor unit. Examples for correct representations (in EUR):</p>
          <ul>
            <li><span class="emphasized">42,20</span> = 42 Euros, 20 Cent</li>
            <li><span class="emphasized">0,23</span> = 23 Cent</li>
            <li><span class="emphasized">1024,42</span> = 1024 Euros, 42 Cent</li>
          </ul>
          <p>When implementing this interface in a specific language or when doing calculations, do not convert the "betrag" field to <span class="emphasized">float</span> / <span class="emphasized">double</span> types. If you do, you might lose precision. To avoid that, use exact formats like <span class="emphasized">BigDecimal</span> in Java (or equivalent in other languages) instead. See <a href="http://stackoverflow.com/a/3730040/342852" target="_blank">Stack Overflow</a> for more info.</p>
          <p>Some JSON parsers (e. g. NodeJS) convert numbers to floats by default. Take this into account when implementing your API and make sure you find a useful solution.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_common_data_types_2"><span class="red">Must:</span> Use common field names and semantics</h3>
        <div class="paragraph">
          <p>A number of field types is required in multiple places. To facilitate consistency across all API implementations, use common field names whenever applicable. When using a common field name, always use it with the same semantic in all places to avoid misunderstandings.</p>
          <h4>Generic Fields</h4>
          <p>Some data fields come up very often in API data:</p>
          <ul>
            <li><span class="emphasized">id</span>: the identity of the object. If used, IDs must be opaque strings and not numbers. IDs are unique within some documented context, are stable and don’t change for a given object once assigned, and are never recycled cross entities.</li>
            <li><span class="emphasized">xyzId</span>: an attribute within one object holding the identifier of another object. The name of the attribute must use a name that corresponds to the type of the referenced object or the relationship to the referenced object followed by <span class="emphasized">Id</span> (e.g. <span class="emphasized">partnerId</span>).</li>
            <li><span class="emphasized">created</span>: when the object was created. If used, this must be a <span class="emphasized">date-time</span> construct.</li>
            <li><span class="emphasized">modified</span>: when the object was updated. If used, this must be a <span class="emphasized">date-time</span> construct.</li>
            <li><span class="emphasized">type</span>: the kind of thing this object is. If used, the type of this field should be a string. Types allow runtime information on the entity provided that otherwise requires examining the Open API file.</li>
          </ul>
          <p><b>Note:</b> There are resources provided by Europace APIs containing attributes containing timestamps of creation (e. g. <span class="emphasized">zeitpunktDerAnnahme</span> in <span class="emphasized">Antrag</span>, baufismart-antraege-api) or last modification (e. g. <span class="emphasized">letzteAenderung</span> in <span class="emphasized">Antrag</span>, baufismart-antraege-api). Nevertheless, to honour their specific semantics in the context of the resource they are part of, these attributes must keep their specific names instead of using the common field name.</p>
          <p>The named properties are not strictly necessary in all of Europace’s APIs. However, when defining properties with the named semantics of these common fields, make use of these fields. This makes it easy for API client developers to build up a common understanding of Europace’s resources and helps you to keep up consistent behavior over the API landscape. There is very little utility for API consumers in having different names or value types for these fields across APIs.</p>
          <h4>Address Fields</h4>
          <p>Address structures play an important role in different functional and use-case contexts in Europace’s APIs. All attributes that relate to address information should follow the naming and semantics defined below.</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              <span class="purple">Postadresse</span>:<br/>
              <span class="purple" style="padding-left: 1em;">type</span>: <span class="red">"object"</span><br/>
              <span class="purple" style="padding-left: 1em;">properties</span>:<br/>
              <span class="purple" style="padding-left: 2em;">hausnummer</span>:<br/>
              <span class="purple" style="padding-left: 3em;">type</span>: <span class="red">"string"</span><br/>
              <span class="purple" style="padding-left: 2em;">ort</span>:<br/>
              <span class="purple" style="padding-left: 3em;">type</span>: <span class="red">"string"</span><br/>
              <span class="purple" style="padding-left: 2em;">postleitzahl</span>:<br/>
              <span class="purple" style="padding-left: 3em;">type</span>: <span class="red">"string"</span><br/>
              <span class="purple" style="padding-left: 2em;">strasse</span>:<br/>
              <span class="purple" style="padding-left: 3em;">type</span>: <span class="red">"string"</span><br/>
              <span class="purple" style="padding-left: 1em;">title</span>: <span class="red">"Postadresse"</span>
            </code>
          </p>
          <p>Grouping and cardinality of fields in specific data types may vary based on the specific use case (e.g. adding addressee name fields to the address fields into a single type vs. separate addressee name and address types when modeling customers and their addresses).</p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_common_headers">18. Common Headers</h2>
    <div class="sectionbody">
      <div class="paragraph">
        <p>This section describes a handful of headers, which might be useful in our daily usage, but are not widely known or raise questions.</p>
      </div>
      <div class="sect2">
        <h3 id="_common_headers_1"><span class="red">Must:</span> Use <span class="emphasized">Content-*</span> Headers Correctly</h3>
        <div class="paragraph">
          <p>Content or entity headers are headers with a <span class="emphasized">Content-</span> prefix. They describe the content of the body of the message and they can be used in HTTP requests as well as responses. Commonly used content headers include but are not limited to:</p>
          <ul>
            <li><a href="https://tools.ietf.org/html/rfc6266#section-3.1.4.2" target="_blank"><span class="emphasized">Content-Disposition</span></a> can indicate that the representation is supposed to be saved as a file, and the proposed file name.</li>
            <li><a href="https://tools.ietf.org/html/rfc7231#section-3.1.2.2" target="_blank"><span class="emphasized">Content-Encoding</span></a> indicates compression or encryption algorithms applied to the content.</li>
            <li><a href="https://tools.ietf.org/html/rfc7230#section-3.3.2" target="_blank"><span class="emphasized">Content-Length</span></a> indicates the length of the content (in bytes).</li>
            <li><a href="https://tools.ietf.org/html/rfc7231#section-3.1.3.2" target="_blank"><span class="emphasized">Content-Language</span></a> indicates that the body is meant for people literate in some human language(s).</li>
            <li><a href="https://tools.ietf.org/html/rfc7231#section-3.1.4.2" target="_blank"><span class="emphasized">Content-Location</span></a> indicates where the body can be found otherwise (<a href="#_common_headers_3"><b><span class="green">May:</span> Use <span class="emphasized">Content-Location</span> Header</b></a> for more details).</li>
            <li><a href="https://tools.ietf.org/html/rfc7233#section-4.2" target="_blank"><span class="emphasized">Content-Range</span></a> is used in responses to range requests to indicate which part of the requested resource representation is delivered with the body.</li>
            <li><a href="https://tools.ietf.org/html/rfc7231#section-3.1.1.5" target="_blank"><span class="emphasized">Content-Type</span></a> indicates the media type of the body content.</li>
          </ul>
          <p>This listing does not imply, that you have to use all of these headers in all requests and responses handled by an API. If you use any of them, make sure, you use them with the correct semantics.</p>
          <p>However, there are two of the above headers we expect to be part of each response delivered by any Europace API, these are</p>
          <ul>
            <li><a href="https://tools.ietf.org/html/rfc7230#section-3.3.2" target="_blank"><span class="emphasized">Content-Length</span></a></li>
            <li><a href="https://tools.ietf.org/html/rfc7231#section-3.1.1.5" target="_blank"><span class="emphasized">Content-Type</span></a></li>
          </ul>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_common_headers_2"><span class="green">May:</span> Use Standardized Headers</h3>
        <div class="paragraph">
          <p>You may use headers from <a href="http://en.wikipedia.org/wiki/List_of_HTTP_header_fields" target="_blank">this list</a> in your API. When using a header, mention its support in your OpenAPI/swagger definition.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_common_headers_3"><span class="green">May:</span> Use <span class="emphasized">Content-Location</span> Header</h3>
        <div class="paragraph">
          <p>The <a href="https://tools.ietf.org/html/rfc7231#section-3.1.4.2" target="_blank"><span class="emphasized">Content-Location</span></a> header is <i>optional</i>. It can be used in successful write operations (<a href="#_http_method_put"><span class="emphasized">PUT</span></a>, <a href="#_http_method_post"><span class="emphasized">POST</span></a>, or <a href="#_http_method_patch"><span class="emphasized">PATCH</span></a>) or read operations (<a href="#_http_method_get"><span class="emphasized">GET</span></a>, <a href="#_http_method_head"><span class="emphasized">HEAD</span></a>) to guide caching and inform the receiver of the actual location of the resource transmitted in the response body. With this clients can identify the resource and update their local copy when receiving a response with this header.</p>
          <p>The <a href="https://tools.ietf.org/html/rfc7231#section-3.1.4.2" target="_blank"><span class="emphasized">Content-Location</span></a> header can be used to support the following use cases:</p>
          <ul>
            <li>For reading operations <a href="#_http_method_get"><span class="emphasized">GET</span></a> and <a href="#_http_method_head"><span class="emphasized">HEAD</span></a>, a location different to the requested URI can be indicate that the resource is subject to content negotiations, the value provides a more specific identifier.</li>
            <li>For writing operations <a href="#_http_method_put"><span class="emphasized">PUT</span></a> and <a href="#_http_method_patch"><span class="emphasized">PATCH</span></a>, a location identical to the requested URI shows explicitly that the returned resource is the current representation of the newly created or updated resource.</li>
            <li>For writing operations <a href="#_http_method_post"><span class="emphasized">POST</span></a> and <a href="#_http_method_delete"><span class="emphasized">DELETE</span></a>, a content location can show that the body contains a status report resource in response to the requested action, available at the provided location.</li>
          </ul>
          <p><b>Note:</b> When using the <a href="https://tools.ietf.org/html/rfc7231#section-3.1.4.2" target="_blank"><span class="emphasized">Content-Location</span></a> header, the <a href="https://tools.ietf.org/html/rfc7231#section-3.1.1.5" target="_blank"><span class="emphasized">Content-Type</span></a> header has to be set as well.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_common_headers_4"><span class="yellow">Should:</span> Use <span class="emphasized">Location</span> Header instead of <span class="emphasized">Content-Location</span> Header</h3>
        <div class="paragraph">
          <p>The correct usage of the <span class="emphasized">Content-Location</span> header with respect to semantics and caching is difficult. We discourage the use of <span class="emphasized">Content-Location</span>. Instead we strongly recommend the usage of <span class="emphasized">Location</span> header, since in most cases directing clients to the resource location is sufficient without the ambiguities and complexities introduced by the <span class="emphasized">Content-Location header</span>.</p>
          <p>More details in RFC 7231 <a href="https://tools.ietf.org/html/rfc7231#section-7.1.2" target="_blank">7.1.2 Location</a>, <a href="https://tools.ietf.org/html/rfc7231#section-3.1.4.2" target="_blank">3.1.4.2 Content-Location</a></p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_common_headers_5"><span class="green">May:</span> Consider to Support <span class="emphasized">ETag</span> Together With <span class="emphasized">If-Match</span>/<span class="emphasized">If-None-Match</span> Header</h3>
        <div class="paragraph">
          <p>On creating or updating resources, there is potential for conflicts on concurrent calls or other problems like, for example “lost updates”. To expose and prevent these problems, you can follow <a href="https://tools.ietf.org/html/rfc7232" target="_blank">RFC 7232 "HTTP: Conditional Requests"</a> by supporting the <a href="https://tools.ietf.org/html/rfc7232#section-2.3" target="_blank"><span class="emphasized">ETag</span></a> header together with the <a href="https://tools.ietf.org/html/rfc7232#section-3.1" target="_blank"><span class="emphasized">If-Match</span></a> or <a href="https://tools.ietf.org/html/rfc7232#section-3.2" target="_blank"><span class="emphasized">If-None-Match</span></a> conditional header. The contents of an <span class="emphasized">ETag: &lt;entity-tag&gt;</span> header is either</p>
          <ol type="a">
            <li>a hash of the response body</li>
            <li>a hash of the last modified field of the entity, or</li>
            <li>a version number or identifier of the entity version.</li>
          </ol>
          <p>By using the <span class="emphasized">If-Match: &lt;entity-tag&gt;</span> header on update operations via <a href="#_http_method_put"><span class="emphasized">PUT</span></a>, <a href="#_http_method_post"><span class="emphasized">POST</span></a>, or <a href="#_http_method_patch"><span class="emphasized">PATCH</span></a>, the server can be forced to check whether the version of the updated entity is conforming to the requested version, exposing conflicts in concurrent calls, if the matching version is not found. If not matching entity is found, the server should respond with status code <a href="#_status_code_412"><span class="emphasized">412</span></a> - precondition failed.</p>
          <p><span class="emphasized">If-None-Match: *</span> can for example be used in a similar use case to expose conflicts in concurrent calls on resource creation. If server checks for a matching entity and finds any, it should respond as well with status code <a href="#_status_code_412"><span class="emphasized">412</span></a> - precondition failed. There are other use cases besides.</p>
          <p>The <a href="https://tools.ietf.org/html/rfc7232#section-2.3" target="_blank"><span class="emphasized">ETag</span></a>, <a href="https://tools.ietf.org/html/rfc7232#section-3.1" target="_blank"><span class="emphasized">If-Match</span></a>, and <a href="https://tools.ietf.org/html/rfc7232#section-3.2" target="_blank"><span class="emphasized">If-None-Match</span></a> headers can be defined as follows in the API definition:</p>
          <p class="preformatted-custom">
            <code style="padding:0">
              <span class="purple">components</span>:<br/>
              <span class="purple" style="padding-left: 1em;">headers</span>:<br/>
              <span style="padding-left: 1em;">- <span class="red">ETag:</span></span><br/>
              <span class="red" style="padding-left: 3em;">description: |</span><br/>
              <span class="red" style="padding-left: 4em;">The RFC 7232 ETag header field in a response provides the entity-tag
                                  of a selected resource. The entity-tag is an opaque identifier for
                                  versions and representations of the same resource over time,
                                  regardless whether multiple versions are valid at the same time. An
                                  entity-tag consists of an opaque quoted string, possibly prefixed by
                                  a weakness indicator (see [RFC 7232 Section 2.3]
                                  (https://tools.ietf.org/html/rfc7232#section-2.3).</span><br/>
              <span class="red" style="padding-left: 3em;">type: string</span><br/>
              <span class="red" style="padding-left: 3em;">required: false</span><br/>
              <span class="red" style="padding-left: 3em;">example: W/"xy", "5", "5db68c06-1a68-11e9-8341-68f728c1ba70"</span><br/><br/>
              <span style="padding-left: 1em;">- <span class="red">If-Match:</span></span><br/>
              <span class="red" style="padding-left: 3em;">description: |</span><br/>
              <span class="red" style="padding-left: 4em;">The RFC7232 If-Match header field in a request requires the server to
                                  only operate on the resource that matches at least one of the
                                  provided entity-tags. This allows clients express a precondition that
                                  prevent the method from being applied if there have been any changes
                                  to the resource (see [RFC 7232 Section 3.1]
                                  (https://tools.ietf.org/html/rfc7232#section-3.1).</span><br/>
              <span class="red" style="padding-left: 3em;">type: string</span><br/>
              <span class="red" style="padding-left: 3em;">required: false</span><br/>
              <span class="red" style="padding-left: 3em;">example: "5", "7da7a728-f910-11e6-942a-68f728c1ba70"</span><br/><br/>
              <span style="padding-left: 1em;">- <span class="red">If-None-Match:</span></span><br/>
              <span class="red" style="padding-left: 3em;">description: |</span><br/>
              <span class="red" style="padding-left: 4em;">The RFC7232 If-None-Match header field in a request requires the
                                  server to only operate on the resource if it does not match any of
                                  the provided entity-tags. If the provided entity-tag is `*`, it is
                                  required that the resource does not exist at all (see [RFC 7232
                                  Section 3.2] (https://tools.ietf.org/html/rfc7232#section-3.2).</span><br/>
              <span class="red" style="padding-left: 3em;">type: string</span><br/>
              <span class="red" style="padding-left: 3em;">required: false</span><br/>
              <span class="red" style="padding-left: 3em;">example: "7da7a728-f910-11e6-942a-68f728c1ba70", *</span><br/>
            </code>
          </p>
          <p><b>Note:</b> Europace’s APIs are working on a highly language specific domain. A lot of the code is therefore written and documented in German. The example above is written in English for consistency reasons with the guideline document. When using the above described headers, feel free to use German in the OpenAPI definition of your API.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_proprietary_headers">19. Proprietary Headers</h2>
    <div class="sectionbody">
      <div class="paragraph">
        <p>This section shares definitions of proprietary headers that should be named consistently across all Europace APIs. Consistent usage of these headers ensure overall correct understanding of the semantics and the correlation between services. Whether services make use of these headers or not is optional; if used, a predefined proprietary header is to be used when possible, and it is to be used with the correct semantics. The OpenAPI specification of your API is the right place to make this visible. Use the parameter definitions of the endpoint HTTP methods.</p>
      </div>
      <div class="sect2">
        <h3 id="_proprietary_headers_1"><span class="red">Must:</span> Use Only the Specified Proprietary Europace Headers</h3>
        <div class="paragraph">
          <p>General rule: avoid proprietary HTTP headers.</p>
          <p>This said, proprietary headers can still be useful in cases where context information has to be passed through multiple services in an end-to-end scenario. A valid use case for the use of a proprietary header is providing context information, which is not a part of the actual API, but is needed in subsequent communication.</p>
          <p>From a conceptual point of view, the semantics and intent of an operation should always be expressed by the URLs path and query parameters, the method, and the content. Headers are more often used to implement functions close to the protocol considerations, such as flow control, content negotiation, and authentication. Thus, headers are reserved for general context information (<a href="https://tools.ietf.org/html/rfc7231#section-5" target="_blank">RFC 7231</a>).</p>
          <p><span class="emphasized">X-</span> headers were initially reserved for unstandardized parameters, but the usage of <span class="emphasized">X-</span> headers is declared deprecated since <a href="https://tools.ietf.org/html/rfc6648" target="_blank">RFC 6648</a>. Therefore there is no standardized way to use these headers, which can complicate defining the contract between consumer and producer of an API. To facilitate uniform handling, the guidelines restrict which <span class="emphasized">X-</span> headers can be used and how to use them.</p>
          <p>The Internet Engineering Task Force states in <a href="https://tools.ietf.org/html/rfc6648" target="_blank">RFC 6648</a> that company specific header names should incorporate the organization’s name. Consider this when you find it necessary to define new proprietary headers for your API. In general, we aim for backward compatibility, and keep the <span class="emphasized">X-</span> prefix to do that.</p>
          <p>The following proprietary headers have been specified by this guideline for usage so far. Remember that HTTP header field names are not case-sensitive.</p>
          <table class="tableblock frame-all grid-all spread">
            <thead>
            <tr>
              <th class="tableblock halign-left valign-middle">Header field name</th>
              <th class="tableblock halign-left valign-middle">Type</th>
              <th class="tableblock halign-left valign-middle">Description</th>
              <th class="tableblock halign-left valign-middle">Header field value example</th>
            </tr>
            </thead>
            <tbody>
              <tr>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock"><span class="emphasized">X-TraceId</span></p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">String</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">For more information see <a href="#_proprietary_headers_3"><b><span class="red">Must:</span> Use <span class="emphasized">X-TraceId</span></b></a>.</p>
                </td>
                <td class="tableblock halign-left valign-middle">
                  <p class="tableblock">p2-ytmpu-backend</p>
                </td>
              </tr>
            </tbody>
          </table>
          <p><b>Exception:</b> The only exception to this guideline are the conventional hop-by-hop <span class="emphasized">X-RateLimit</span>-headers which can be used as defined in <a href="#_http_status_codes_4"><b><span class="red">Must:</span> Use Code 429 with Headers for Rate Limits</b></a>.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_proprietary_headers_2"><span class="red">Must:</span> Propagate Proprietary Headers</h3>
        <div class="paragraph">
          <p>All Europace’s proprietary headers are end-to-end headers.</p>
          <p>All headers specified above must be propagated to all services down the call chain. The header names and values must remain unchanged.</p>
          <p>For example, the values of the custom headers like <a href="#_proprietary_headers_3"><span class="emphasized">X-TraceId</span></a> is used to check the flow of a business process across the platform. It therefore is important to not change the value to make the steps belonging one business process identifiable.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_proprietary_headers_3"><span class="red">Must:</span> Use <span class="emphasized">X-TraceId</span></h3>
        <div class="paragraph">
          <p>The <b>Trace-Id</b> is a generic parameter to be passed through service APIs and events and written into log files and traces. A consequent usage of the <b>Trace-Id</b> allows tracking of call flows through the system and correlation of all activities belonging to one business call. This is extremely helpful for operational troubleshooting and log analysis. Main use case of <b>Trace-Id</b> is to track service calls of our Business platform and initiated internal processing flows.</p>
          <h4>Data Definition</h4>
          <p>The <b>Trace-Id</b> must be passed through:</p>
          <ul>
            <li>RESTful API requests via <span class="emphasized">X-TraceId</span> proprietary header (see <a href="#_proprietary_headers_2"><b><span class="red">Must:</span> Propagate Proprietary Headers</b></a>)</li>
          </ul>
          <p><b>Note:</b> If a legacy subsystem can only process Trace-Ids with a specific format or length, it must define this restrictions in its API specification, and be generous and remove invalid characters or cut the length to the supported limit.</p>
          <h4>Service Guidance</h4>
          <ul>
            <li>Services <i>must</i> support <b>Trace-Id</b> as generic input, i.e. RESTful API endpoints <i>must</i> support <span class="emphasized">X-TraceId</span> header in requests<br/><br/>
              <b>Note:</b> API-Clients <i>must</i> provide <b>Trace-Id</b> when calling a service. If no <b>Trace-Id</b> is provided in a request, the service must create a new <b>Trace-Id</b>.<br/><br/>
            </li>
            <li>Services <i>must</i> propagate <b>Trace-Id</b>, i.e. use <b>Trace-Id</b> received with API-Calls as...
              <ul>
                <li>input for all API called and events published during processing</li>
                <li>data field written for logging and tracing</li>
              </ul>
            </li>
          </ul>
          <p><b>Hint:</b> This rule also applies to application internal interfaces.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_api_operation">20. API Operation</h2>
    <div class="sectionbody">
      <div class="sect2">
        <h3 id="_api_operation_1"><span class="red">Must:</span> Publish OpenAPI Specification</h3>
        <div class="paragraph">
          <p>All service applications must publish OpenAPI specifications of their external APIs.</p>
          <p>This is optional for internal internal APIs, but we recommend to do so to profit from the API management infrastructure and to make switch from internal use to external as easy as possible.</p>
          <p>An API is published by committing its <b>OpenAPI specification</b> to the reserved API-related public GitHub repository in our Europace-Organisation on github.com. The repository must only contain <b>self-contained YAML files</b> that each describe one API (exception see <a href="#_general_3"><b><span class="red">Must:</span> only use Durable and Immutable Remote References</b></a>).</p>
          <p><b>Note:</b> It is important to provide API client developers a clearly structured online accessible central place to the API specifications to enable them to implement access to our service infrastructure in an easy to understand way.</p>
          <p><b>Note:</b> To publish an API, it is still necessary to deploy the artifact successful, as we focus the discovery experience on APIs supported by running services.</p>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_api_operation_2"><span class="yellow">Should:</span> Monitor API Usage</h3>
        <div class="paragraph">
          <p>API services used in production should be monitored to get information about client usage, performance and load. This information can be used to identify potential review partners for API changes, to identify bottlenecks and memory leaks.</p>
          <p><b>Hint:</b> A good way of client detection implementation is by logging of the client-id retrieved from the OAuth token.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="sect1">
    <h2 id="_appendix">Appendix: References</h2>
    <div class="sectionbody">
      <div class="paragraph">
        <p>This section collects links to documents to which we refer, and base our guidelines on.</p>
      </div>
      <div class="sect2">
        <h3 id="_appendix_1">OpenAPI Specification</h3>
        <div class="paragraph">
          <ul>
            <li><a href="https://github.com/OAI/OpenAPI-Specification/" target="_blank">OpenAPI Specification</a></li>
            <li><a href="https://openapi-map.apihandyman.io" target="_blank">OpenAPI Specification Mind Map</a></li>
          </ul>
        </div>
      </div>
      <div class="sect2">
        <h3 id="_appendix_2">Publications, specifications and standards</h3>
        <div class="paragraph">
          <ul>
            <li><a href="https://tools.ietf.org/html/rfc4627" target="_blank">RFC 4627</a>: The application/json Media Type for JavaScript Object Notation (JSON)</li>
            <li><a href="https://tools.ietf.org/html/rfc5988" target="_blank">RFC 5988</a>: Web Linking</li>
            <li><a href="https://tools.ietf.org/html/rfc6585" target="_blank">RFC 6585</a>: Additional HTTP Status Codes</li>
            <li><a href="https://tools.ietf.org/html/rfc6902" target="_blank">RFC 6902</a>: JavaScript Object Notation (JSON) Patch</li>
            <li><a href="https://tools.ietf.org/html/rfc7159" target="_blank">RFC 7159</a>: The JavaScript Object Notation (JSON) Data Interchange Format</li>
            <li><a href="https://tools.ietf.org/html/rfc7230" target="_blank">RFC 7230</a>: Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</li>
            <li><a href="https://tools.ietf.org/html/rfc7231" target="_blank">RFC 7231</a>: Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</li>
            <li><a href="https://tools.ietf.org/html/rfc7232" target="_blank">RFC 7232</a>: Hypertext Transfer Protocol (HTTP/1.1): Conditional Requests</li>
            <li><a href="https://tools.ietf.org/html/rfc7233" target="_blank">RFC 7233</a>: Hypertext Transfer Protocol (HTTP/1.1): Range Requests</li>
            <li><a href="https://tools.ietf.org/html/rfc7234" target="_blank">RFC 7234</a>: Hypertext Transfer Protocol (HTTP/1.1): Caching</li>
            <li><a href="https://tools.ietf.org/html/rfc7396" target="_blank">RFC 7396</a>: JSON Merge Patch</li>
            <li><a href="https://tools.ietf.org/html/rfc7807" target="_blank">RFC 7807</a>: Problem Details for HTTP APIs</li>
            <li><a href="https://en.wikipedia.org/wiki/ISO_8601" target="_blank">ISO 8601</a>: Date and time format</li>
            <li><a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2" target="_blank">ISO 3166-1 alpha-2</a>: Two letter country codes</li>
            <li><a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes" target="_blank">ISO 639-1</a>: Two letter language codes</li>
            <li><a href="https://en.wikipedia.org/wiki/ISO_4217" target="_blank">ISO 4217</a>: Currency codes</li>
            <li><a href="https://tools.ietf.org/html/bcp47" target="_blank">BCP 47</a>: Tags for Identifying Languages</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
</body>
</html>
